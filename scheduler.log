[Fx] PROVIDE	fx.Lifecycle <= go.uber.org/fx.New.func1()
[Fx] PROVIDE	fx.Shutdowner <= go.uber.org/fx.(*App).shutdowner-fm()
[Fx] PROVIDE	fx.DotGraph <= go.uber.org/fx.(*App).dotGraph-fm()
[Fx] PROVIDE	*config.Config <= ethereum-raw-data-crawler/internal/infrastructure/config.LoadConfig()
[Fx] PROVIDE	*config.MongoDBConfig <= main.provideMongoDBConfig()
[Fx] PROVIDE	*config.EthereumConfig <= main.provideEthereumConfig()
[Fx] PROVIDE	*logger.Logger <= ethereum-raw-data-crawler/internal/infrastructure/logger.NewLogger()
[Fx] PROVIDE	*database.MongoDB <= ethereum-raw-data-crawler/internal/infrastructure/database.NewMongoDB()
[Fx] PROVIDE	service.MessagingService <= fx.Annotate(ethereum-raw-data-crawler/internal/infrastructure/messaging.NewNATSMessagingService(), fx.As([[service.MessagingService]])
[Fx] PROVIDE	service.BlockchainService <= fx.Annotate(ethereum-raw-data-crawler/internal/infrastructure/blockchain.NewEthereumService(), fx.As([[service.BlockchainService]])
[Fx] PROVIDE	service.BlockSchedulerService <= fx.Annotate(ethereum-raw-data-crawler/internal/infrastructure/blockchain.NewWebSocketScheduler(), fx.As([[service.BlockSchedulerService]])
[Fx] PROVIDE	repository.BlockRepository <= fx.Annotate(ethereum-raw-data-crawler/internal/adapters/secondary.NewBlockRepository(), fx.As([[repository.BlockRepository]])
[Fx] PROVIDE	repository.TransactionRepository <= fx.Annotate(ethereum-raw-data-crawler/internal/adapters/secondary.NewTransactionRepository(), fx.As([[repository.TransactionRepository]])
[Fx] PROVIDE	repository.MetricsRepository <= fx.Annotate(ethereum-raw-data-crawler/internal/adapters/secondary.NewMetricsRepository(), fx.As([[repository.MetricsRepository]])
[Fx] PROVIDE	*service.CrawlerService <= ethereum-raw-data-crawler/internal/application/service.NewCrawlerService()
[Fx] PROVIDE	*service.SchedulerService <= ethereum-raw-data-crawler/internal/application/service.NewSchedulerService()
[Fx] INVOKE		main.registerSchedulerHooks()
[Fx] BEFORE RUN	provide: go.uber.org/fx.New.func1()
[Fx] RUN	provide: go.uber.org/fx.New.func1() in 2.458µs
[Fx] BEFORE RUN	provide: ethereum-raw-data-crawler/internal/infrastructure/config.LoadConfig()
[Fx] RUN	provide: ethereum-raw-data-crawler/internal/infrastructure/config.LoadConfig() in 580.875µs
[Fx] BEFORE RUN	provide: ethereum-raw-data-crawler/internal/infrastructure/logger.NewLogger()
[Fx] RUN	provide: ethereum-raw-data-crawler/internal/infrastructure/logger.NewLogger() in 43.167µs
[Fx] BEFORE RUN	provide: main.provideMongoDBConfig()
[Fx] RUN	provide: main.provideMongoDBConfig() in 1.75µs
[Fx] BEFORE RUN	provide: ethereum-raw-data-crawler/internal/infrastructure/database.NewMongoDB()
[Fx] RUN	provide: ethereum-raw-data-crawler/internal/infrastructure/database.NewMongoDB() in 796.767125ms
[Fx] BEFORE RUN	provide: fx.Annotate(ethereum-raw-data-crawler/internal/infrastructure/messaging.NewNATSMessagingService(), fx.As([[service.MessagingService]])
[Fx] RUN	provide: fx.Annotate(ethereum-raw-data-crawler/internal/infrastructure/messaging.NewNATSMessagingService(), fx.As([[service.MessagingService]]) in 92.833µs
[Fx] BEFORE RUN	provide: main.provideEthereumConfig()
[Fx] RUN	provide: main.provideEthereumConfig() in 3.875µs
[Fx] BEFORE RUN	provide: fx.Annotate(ethereum-raw-data-crawler/internal/infrastructure/blockchain.NewEthereumService(), fx.As([[service.BlockchainService]])
[Fx] RUN	provide: fx.Annotate(ethereum-raw-data-crawler/internal/infrastructure/blockchain.NewEthereumService(), fx.As([[service.BlockchainService]]) in 18.291µs
[Fx] BEFORE RUN	provide: fx.Annotate(ethereum-raw-data-crawler/internal/adapters/secondary.NewBlockRepository(), fx.As([[repository.BlockRepository]])
[Fx] RUN	provide: fx.Annotate(ethereum-raw-data-crawler/internal/adapters/secondary.NewBlockRepository(), fx.As([[repository.BlockRepository]]) in 7.209µs
[Fx] BEFORE RUN	provide: fx.Annotate(ethereum-raw-data-crawler/internal/adapters/secondary.NewTransactionRepository(), fx.As([[repository.TransactionRepository]])
[Fx] RUN	provide: fx.Annotate(ethereum-raw-data-crawler/internal/adapters/secondary.NewTransactionRepository(), fx.As([[repository.TransactionRepository]]) in 3.416µs
[Fx] BEFORE RUN	provide: fx.Annotate(ethereum-raw-data-crawler/internal/adapters/secondary.NewMetricsRepository(), fx.As([[repository.MetricsRepository]])
[Fx] RUN	provide: fx.Annotate(ethereum-raw-data-crawler/internal/adapters/secondary.NewMetricsRepository(), fx.As([[repository.MetricsRepository]]) in 3.916µs
[Fx] BEFORE RUN	provide: ethereum-raw-data-crawler/internal/application/service.NewCrawlerService()
[Fx] RUN	provide: ethereum-raw-data-crawler/internal/application/service.NewCrawlerService() in 13.75µs
[Fx] BEFORE RUN	provide: fx.Annotate(ethereum-raw-data-crawler/internal/infrastructure/blockchain.NewWebSocketScheduler(), fx.As([[service.BlockSchedulerService]])
[Fx] RUN	provide: fx.Annotate(ethereum-raw-data-crawler/internal/infrastructure/blockchain.NewWebSocketScheduler(), fx.As([[service.BlockSchedulerService]]) in 17.375µs
[Fx] BEFORE RUN	provide: ethereum-raw-data-crawler/internal/application/service.NewSchedulerService()
[Fx] RUN	provide: ethereum-raw-data-crawler/internal/application/service.NewSchedulerService() in 17µs
[Fx] HOOK OnStart		main.registerSchedulerHooks.func1() executing (caller: main.registerSchedulerHooks)
2025-06-23T16:47:54.306+0700	INFO	schedulers/main.go:114	Starting Ethereum Block Scheduler	{"version": "1.0.0", "network": "ethereum", "scheduler_mode": "realtime"}
2025-06-23T16:47:54.821+0700	INFO	messaging/nats_client.go:56	NATS is disabled, skipping connection	{"component": "nats-client"}
2025-06-23T16:47:54.821+0700	INFO	service/crawler_service.go:94	Starting crawler service	{"component": "crawler-service"}
2025-06-23T16:47:54.821+0700	INFO	blockchain/ethereum_service.go:44	Connecting to Ethereum node	{"component": "ethereum-service", "rpc_url": "https://mainnet.infura.io/v3/fc066db3e5254dd88e0890320478bc75"}
2025-06-23T16:47:55.836+0700	INFO	blockchain/ethereum_service.go:62	Successfully connected to Ethereum node	{"component": "ethereum-service"}
2025-06-23T16:47:56.058+0700	INFO	service/crawler_service.go:215	Resuming from last processed block	{"component": "crawler-service", "last_block": "22766332", "current_block": "22766333"}
2025-06-23T16:47:56.058+0700	INFO	service/crawler_service.go:112	Crawler started in external scheduler mode	{"component": "crawler-service"}
2025-06-23T16:47:56.058+0700	INFO	service/crawler_service.go:122	Crawler service started successfully	{"component": "crawler-service", "current_block": "22766333"}
2025-06-23T16:47:56.058+0700	INFO	service/scheduler_service.go:85	Starting scheduler service	{"component": "scheduler-service", "mode": "realtime"}
2025-06-23T16:47:56.058+0700	INFO	blockchain/websocket_scheduler.go:51	Starting WebSocket scheduler	{"component": "websocket-scheduler", "ws_url": "wss://eth-mainnet.ws.alchemyapi.io/ws/x6DMAG9Zx4vOWVlS3Dov4"}
2025-06-23T16:47:56.911+0700	INFO	blockchain/websocket_scheduler.go:148	Successfully connected to WebSocket	{"component": "websocket-scheduler"}
2025-06-23T16:47:56.911+0700	INFO	blockchain/websocket_scheduler.go:316	Connection monitor started	{"component": "websocket-scheduler"}
2025-06-23T16:47:56.912+0700	DEBUG	blockchain/websocket_scheduler.go:165	Sent subscription request for new blocks	{"component": "websocket-scheduler"}
2025-06-23T16:47:56.912+0700	INFO	blockchain/websocket_scheduler.go:117	Successfully subscribed to new block events	{"component": "websocket-scheduler"}
2025-06-23T16:47:56.912+0700	INFO	service/scheduler_service.go:169	Scheduler started in realtime mode	{"component": "scheduler-service"}
2025-06-23T16:47:56.912+0700	INFO	schedulers/main.go:165	Ethereum Block Scheduler started successfully	{"mode": "realtime", "realtime_enabled": true, "polling_enabled": true}
[Fx] HOOK OnStart		main.registerSchedulerHooks.func1() called by main.registerSchedulerHooks ran successfully in 2.60569075s
[Fx] RUNNING
2025-06-23T16:47:56.912+0700	INFO	blockchain/websocket_scheduler.go:201	Message listener started	{"component": "websocket-scheduler"}
2025-06-23T16:47:57.217+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": null}
2025-06-23T16:47:57.217+0700	INFO	blockchain/websocket_scheduler.go:269	Received subscription ID	{"component": "websocket-scheduler", "sub_id": "0x6effb5b08de549f5a7e01ced69862af9"}
2025-06-23T16:48:01.172+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:48:01.172+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766333"}
2025-06-23T16:48:01.172+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766333"}
2025-06-23T16:48:01.172+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766333"}
2025-06-23T16:48:01.172+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766333, "block_number": 22766333}
2025-06-23T16:48:01.172+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766333"}
2025-06-23T16:48:02.014+0700	INFO	service/crawler_service.go:397	Block already exists, skipping block save	{"component": "crawler-service", "block_number": 22766333, "block_hash": "0x242a5ececedd417c0dfe2418734dd0f0755ec750d0c965797ea71079af4ba26a", "existing_hash": "0x242a5ececedd417c0dfe2418734dd0f0755ec750d0c965797ea71079af4ba26a"}
2025-06-23T16:48:02.014+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766333, "tx_hash_count": 160}
2025-06-23T16:48:02.272+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766333", "tx_count": 160}
2025-06-23T16:48:02.274+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 10, "total": 160}
2025-06-23T16:48:02.274+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 20, "total": 160}
2025-06-23T16:48:02.274+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 30, "total": 160}
2025-06-23T16:48:02.275+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 40, "total": 160}
2025-06-23T16:48:02.275+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 50, "total": 160}
2025-06-23T16:48:02.276+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 60, "total": 160}
2025-06-23T16:48:02.276+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 70, "total": 160}
2025-06-23T16:48:02.277+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 80, "total": 160}
2025-06-23T16:48:02.278+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 90, "total": 160}
2025-06-23T16:48:02.279+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 100, "total": 160}
2025-06-23T16:48:02.279+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 110, "total": 160}
2025-06-23T16:48:02.280+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 120, "total": 160}
2025-06-23T16:48:02.280+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 130, "total": 160}
2025-06-23T16:48:02.281+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 140, "total": 160}
2025-06-23T16:48:02.281+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 150, "total": 160}
2025-06-23T16:48:02.281+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766333", "processed": 160, "total": 160}
2025-06-23T16:48:02.281+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766333", "successful": 160}
2025-06-23T16:48:02.281+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766333, "count": 160}
2025-06-23T16:48:02.281+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766333}
2025-06-23T16:48:02.281+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766333, "transaction_count": 160}
2025-06-23T16:48:04.200+0700	WARN	service/crawler_service.go:466	Batch upsert failed	{"component": "crawler-service", "block_number": 22766333, "error": "bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +134 more errors...]", "transaction_count": 160, "duration": "1.91899075s"}
2025-06-23T16:48:04.200+0700	INFO	service/crawler_service.go:473	Falling back to batch insert	{"component": "crawler-service", "block_number": 22766333, "transaction_count": 160}
2025-06-23T16:48:05.058+0700	ERROR	service/crawler_service.go:478	Fallback batch insert also failed	{"component": "crawler-service", "block_number": 22766333, "error": "bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0x6480b38aa8226b5da614086ba4c3970c575f61c659bfbca3bdb4556ab949443d\" }]", "transaction_count": 160, "fallback_duration": "856.538917ms", "total_duration": "2.776388416s"}
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).saveTransactions
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:478
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).processBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:427
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).ProcessSpecificBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:363
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:219
2025-06-23T16:48:05.059+0700	ERROR	service/scheduler_service.go:220	Failed to process new block	{"component": "scheduler-service", "block_number": "22766333", "error": "failed to save transactions for block 22766333: both upsert and insert failed: upsert=bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +134 more errors...], insert=bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0x6480b38aa8226b5da614086ba4c3970c575f61c659bfbca3bdb4556ab949443d\" }]"}
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:220
2025-06-23T16:48:13.354+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:48:13.355+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766334"}
2025-06-23T16:48:13.355+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766334"}
2025-06-23T16:48:13.355+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766334"}
2025-06-23T16:48:13.355+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766334, "block_number": 22766334}
2025-06-23T16:48:13.355+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766334"}
2025-06-23T16:48:13.834+0700	WARN	service/crawler_service.go:405	Block already exists (race condition), continuing	{"component": "crawler-service", "block_number": 22766334, "block_hash": "0xb52854e0e0cf882e50f6aaae5e93799e45cd6f289b9ac0f4aac5606b3d9ac48b"}
2025-06-23T16:48:13.834+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766334, "tx_hash_count": 201}
2025-06-23T16:48:14.116+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766334", "tx_count": 201}
2025-06-23T16:48:14.116+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 10, "total": 201}
2025-06-23T16:48:14.117+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 20, "total": 201}
2025-06-23T16:48:14.117+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 30, "total": 201}
2025-06-23T16:48:14.117+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 40, "total": 201}
2025-06-23T16:48:14.118+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 50, "total": 201}
2025-06-23T16:48:14.118+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 60, "total": 201}
2025-06-23T16:48:14.119+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 70, "total": 201}
2025-06-23T16:48:14.119+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 80, "total": 201}
2025-06-23T16:48:14.119+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 90, "total": 201}
2025-06-23T16:48:14.120+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 100, "total": 201}
2025-06-23T16:48:14.120+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 110, "total": 201}
2025-06-23T16:48:14.121+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 120, "total": 201}
2025-06-23T16:48:14.121+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 130, "total": 201}
2025-06-23T16:48:14.122+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 140, "total": 201}
2025-06-23T16:48:14.122+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 150, "total": 201}
2025-06-23T16:48:14.122+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 160, "total": 201}
2025-06-23T16:48:14.123+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 170, "total": 201}
2025-06-23T16:48:14.123+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 180, "total": 201}
2025-06-23T16:48:14.123+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 190, "total": 201}
2025-06-23T16:48:14.124+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766334", "processed": 200, "total": 201}
2025-06-23T16:48:14.124+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766334", "successful": 201}
2025-06-23T16:48:14.124+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766334, "count": 201}
2025-06-23T16:48:14.124+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766334}
2025-06-23T16:48:14.124+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766334, "transaction_count": 201}
2025-06-23T16:48:14.991+0700	DEBUG	service/crawler_service.go:497	Batch upsert succeeded	{"component": "crawler-service", "block_number": 22766334, "transaction_count": 201, "duration": "866.968459ms"}
2025-06-23T16:48:14.991+0700	INFO	service/crawler_service.go:430	Transactions saved to database	{"component": "crawler-service", "block_number": 22766334, "count": 201}
2025-06-23T16:48:15.732+0700	INFO	service/crawler_service.go:441	Block processed successfully	{"component": "crawler-service", "block_number": 22766334, "transaction_count": 201}
2025-06-23T16:48:25.498+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:48:25.499+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766335"}
2025-06-23T16:48:25.499+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766335"}
2025-06-23T16:48:25.499+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766335"}
2025-06-23T16:48:25.499+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766335, "block_number": 22766335}
2025-06-23T16:48:25.499+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766335"}
2025-06-23T16:48:26.290+0700	WARN	service/crawler_service.go:405	Block already exists (race condition), continuing	{"component": "crawler-service", "block_number": 22766335, "block_hash": "0x038750518176afebf1e36223a564775b1b0ef937430c343c2acdd497aa158c3d"}
2025-06-23T16:48:26.291+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766335, "tx_hash_count": 228}
2025-06-23T16:48:26.559+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766335", "tx_count": 228}
2025-06-23T16:48:26.559+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 10, "total": 228}
2025-06-23T16:48:26.560+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 20, "total": 228}
2025-06-23T16:48:26.560+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 30, "total": 228}
2025-06-23T16:48:26.561+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 40, "total": 228}
2025-06-23T16:48:26.561+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 50, "total": 228}
2025-06-23T16:48:26.561+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 60, "total": 228}
2025-06-23T16:48:26.562+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 70, "total": 228}
2025-06-23T16:48:26.562+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 80, "total": 228}
2025-06-23T16:48:26.563+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 90, "total": 228}
2025-06-23T16:48:26.563+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 100, "total": 228}
2025-06-23T16:48:26.563+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 110, "total": 228}
2025-06-23T16:48:26.564+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 120, "total": 228}
2025-06-23T16:48:26.564+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 130, "total": 228}
2025-06-23T16:48:26.564+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 140, "total": 228}
2025-06-23T16:48:26.565+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 150, "total": 228}
2025-06-23T16:48:26.565+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 160, "total": 228}
2025-06-23T16:48:26.566+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 170, "total": 228}
2025-06-23T16:48:26.566+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 180, "total": 228}
2025-06-23T16:48:26.566+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 190, "total": 228}
2025-06-23T16:48:26.567+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 200, "total": 228}
2025-06-23T16:48:26.567+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 210, "total": 228}
2025-06-23T16:48:26.568+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766335", "processed": 220, "total": 228}
2025-06-23T16:48:26.568+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766335", "successful": 228}
2025-06-23T16:48:26.568+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766335, "count": 228}
2025-06-23T16:48:26.568+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766335}
2025-06-23T16:48:26.568+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766335, "transaction_count": 228}
2025-06-23T16:48:26.921+0700	DEBUG	blockchain/websocket_scheduler.go:364	Sending WebSocket ping	{"component": "websocket-scheduler"}
2025-06-23T16:48:26.922+0700	DEBUG	blockchain/websocket_scheduler.go:374	WebSocket ping successful	{"component": "websocket-scheduler"}
2025-06-23T16:48:27.020+0700	INFO	service/crawler_service.go:757	Health check completed	{"component": "crawler-service", "overall_status": "healthy", "message": "All systems operational", "total_time": "950.659416ms", "consecutive_failures": 0}
2025-06-23T16:48:28.070+0700	WARN	service/crawler_service.go:466	Batch upsert failed	{"component": "crawler-service", "block_number": 22766335, "error": "bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +202 more errors...]", "transaction_count": 228, "duration": "1.501140167s"}
2025-06-23T16:48:28.070+0700	INFO	service/crawler_service.go:473	Falling back to batch insert	{"component": "crawler-service", "block_number": 22766335, "transaction_count": 228}
2025-06-23T16:48:28.921+0700	ERROR	service/crawler_service.go:478	Fallback batch insert also failed	{"component": "crawler-service", "block_number": 22766335, "error": "bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0xdf4fe6f77e1afd717d55bb935deb988e5fa6054601b68ab0d02118ecb8a27815\" }]", "transaction_count": 228, "fallback_duration": "849.4655ms", "total_duration": "2.350694s"}
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).saveTransactions
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:478
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).processBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:427
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).ProcessSpecificBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:363
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:219
2025-06-23T16:48:28.921+0700	ERROR	service/scheduler_service.go:220	Failed to process new block	{"component": "scheduler-service", "block_number": "22766335", "error": "failed to save transactions for block 22766335: both upsert and insert failed: upsert=bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +202 more errors...], insert=bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0xdf4fe6f77e1afd717d55bb935deb988e5fa6054601b68ab0d02118ecb8a27815\" }]"}
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:220
2025-06-23T16:48:38.168+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:48:38.168+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766336"}
2025-06-23T16:48:38.169+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766336"}
2025-06-23T16:48:38.169+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766336"}
2025-06-23T16:48:38.169+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766336, "block_number": 22766336}
2025-06-23T16:48:38.169+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766336"}
2025-06-23T16:48:38.688+0700	WARN	service/crawler_service.go:405	Block already exists (race condition), continuing	{"component": "crawler-service", "block_number": 22766336, "block_hash": "0x7ff747a9d9c55fa098fc6ac4c111b43a5a5643b0952ce6ebc5b1fc8e933c9be5"}
2025-06-23T16:48:38.689+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766336, "tx_hash_count": 183}
2025-06-23T16:48:38.970+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766336", "tx_count": 183}
2025-06-23T16:48:38.970+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 10, "total": 183}
2025-06-23T16:48:38.970+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 20, "total": 183}
2025-06-23T16:48:38.971+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 30, "total": 183}
2025-06-23T16:48:38.971+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 40, "total": 183}
2025-06-23T16:48:38.972+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 50, "total": 183}
2025-06-23T16:48:38.972+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 60, "total": 183}
2025-06-23T16:48:38.973+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 70, "total": 183}
2025-06-23T16:48:38.973+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 80, "total": 183}
2025-06-23T16:48:38.973+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 90, "total": 183}
2025-06-23T16:48:38.974+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 100, "total": 183}
2025-06-23T16:48:38.974+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 110, "total": 183}
2025-06-23T16:48:38.974+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 120, "total": 183}
2025-06-23T16:48:38.975+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 130, "total": 183}
2025-06-23T16:48:38.975+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 140, "total": 183}
2025-06-23T16:48:38.976+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 150, "total": 183}
2025-06-23T16:48:38.976+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 160, "total": 183}
2025-06-23T16:48:38.976+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 170, "total": 183}
2025-06-23T16:48:38.977+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766336", "processed": 180, "total": 183}
2025-06-23T16:48:38.977+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766336", "successful": 183}
2025-06-23T16:48:38.977+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766336, "count": 183}
2025-06-23T16:48:38.977+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766336}
2025-06-23T16:48:38.977+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766336, "transaction_count": 183}
2025-06-23T16:48:40.728+0700	WARN	service/crawler_service.go:466	Batch upsert failed	{"component": "crawler-service", "block_number": 22766336, "error": "bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +157 more errors...]", "transaction_count": 183, "duration": "1.750278166s"}
2025-06-23T16:48:40.728+0700	INFO	service/crawler_service.go:473	Falling back to batch insert	{"component": "crawler-service", "block_number": 22766336, "transaction_count": 183}
2025-06-23T16:48:41.552+0700	ERROR	service/crawler_service.go:478	Fallback batch insert also failed	{"component": "crawler-service", "block_number": 22766336, "error": "bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0xb84daa8b72b7b9fefa4182da25ad9bc90aa8bee4a5110b6dd1a85b4ed8896cea\" }]", "transaction_count": 183, "fallback_duration": "823.701167ms", "total_duration": "2.574251291s"}
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).saveTransactions
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:478
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).processBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:427
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).ProcessSpecificBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:363
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:219
2025-06-23T16:48:41.552+0700	ERROR	service/scheduler_service.go:220	Failed to process new block	{"component": "scheduler-service", "block_number": "22766336", "error": "failed to save transactions for block 22766336: both upsert and insert failed: upsert=bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +157 more errors...], insert=bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0xb84daa8b72b7b9fefa4182da25ad9bc90aa8bee4a5110b6dd1a85b4ed8896cea\" }]"}
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:220
2025-06-23T16:48:49.207+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:48:49.207+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766337"}
2025-06-23T16:48:49.207+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766337"}
2025-06-23T16:48:49.207+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766337"}
2025-06-23T16:48:49.207+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766337, "block_number": 22766337}
2025-06-23T16:48:49.207+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766337"}
2025-06-23T16:48:49.936+0700	WARN	service/crawler_service.go:405	Block already exists (race condition), continuing	{"component": "crawler-service", "block_number": 22766337, "block_hash": "0x5e4098149802be85b03afc993c7c39ff61c7796f85212d6b4721c17fc3fc2a67"}
2025-06-23T16:48:49.936+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766337, "tx_hash_count": 235}
2025-06-23T16:48:50.212+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766337", "tx_count": 235}
2025-06-23T16:48:50.213+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 10, "total": 235}
2025-06-23T16:48:50.213+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 20, "total": 235}
2025-06-23T16:48:50.214+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 30, "total": 235}
2025-06-23T16:48:50.214+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 40, "total": 235}
2025-06-23T16:48:50.214+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 50, "total": 235}
2025-06-23T16:48:50.215+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 60, "total": 235}
2025-06-23T16:48:50.215+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 70, "total": 235}
2025-06-23T16:48:50.216+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 80, "total": 235}
2025-06-23T16:48:50.216+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 90, "total": 235}
2025-06-23T16:48:50.216+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 100, "total": 235}
2025-06-23T16:48:50.217+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 110, "total": 235}
2025-06-23T16:48:50.221+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 120, "total": 235}
2025-06-23T16:48:50.225+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 130, "total": 235}
2025-06-23T16:48:50.226+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 140, "total": 235}
2025-06-23T16:48:50.227+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 150, "total": 235}
2025-06-23T16:48:50.227+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 160, "total": 235}
2025-06-23T16:48:50.228+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 170, "total": 235}
2025-06-23T16:48:50.228+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 180, "total": 235}
2025-06-23T16:48:50.229+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 190, "total": 235}
2025-06-23T16:48:50.229+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 200, "total": 235}
2025-06-23T16:48:50.229+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 210, "total": 235}
2025-06-23T16:48:50.230+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 220, "total": 235}
2025-06-23T16:48:50.230+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766337", "processed": 230, "total": 235}
2025-06-23T16:48:50.230+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766337", "successful": 235}
2025-06-23T16:48:50.230+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766337, "count": 235}
2025-06-23T16:48:50.230+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766337}
2025-06-23T16:48:50.230+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766337, "transaction_count": 235}
2025-06-23T16:48:52.799+0700	WARN	service/crawler_service.go:466	Batch upsert failed	{"component": "crawler-service", "block_number": 22766337, "error": "bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +209 more errors...]", "transaction_count": 235, "duration": "2.567813041s"}
2025-06-23T16:48:52.799+0700	INFO	service/crawler_service.go:473	Falling back to batch insert	{"component": "crawler-service", "block_number": 22766337, "transaction_count": 235}
2025-06-23T16:48:53.618+0700	ERROR	service/crawler_service.go:478	Fallback batch insert also failed	{"component": "crawler-service", "block_number": 22766337, "error": "bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0x8352abce3bfadfab08456b9467cd6a88c5442af0df61cde86f241aa1d54d2e4d\" }]", "transaction_count": 235, "fallback_duration": "819.247125ms", "total_duration": "3.387334s"}
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).saveTransactions
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:478
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).processBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:427
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).ProcessSpecificBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:363
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:219
2025-06-23T16:48:53.619+0700	ERROR	service/scheduler_service.go:220	Failed to process new block	{"component": "scheduler-service", "block_number": "22766337", "error": "failed to save transactions for block 22766337: both upsert and insert failed: upsert=bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +209 more errors...], insert=bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0x8352abce3bfadfab08456b9467cd6a88c5442af0df61cde86f241aa1d54d2e4d\" }]"}
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:220
2025-06-23T16:48:56.684+0700	INFO	service/crawler_service.go:757	Health check completed	{"component": "crawler-service", "overall_status": "healthy", "message": "All systems operational", "total_time": "603.6155ms", "consecutive_failures": 0}
2025-06-23T16:48:56.933+0700	DEBUG	blockchain/websocket_scheduler.go:364	Sending WebSocket ping	{"component": "websocket-scheduler"}
2025-06-23T16:48:56.933+0700	DEBUG	blockchain/websocket_scheduler.go:374	WebSocket ping successful	{"component": "websocket-scheduler"}
2025-06-23T16:49:01.186+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:49:01.186+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766338"}
2025-06-23T16:49:01.186+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766338"}
2025-06-23T16:49:01.186+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766338"}
2025-06-23T16:49:01.186+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766338, "block_number": 22766338}
2025-06-23T16:49:01.186+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766338"}
2025-06-23T16:49:01.722+0700	WARN	service/crawler_service.go:405	Block already exists (race condition), continuing	{"component": "crawler-service", "block_number": 22766338, "block_hash": "0x5e36d414fdd839fa9e6e77fe92e0fd529c070dca663bdf9427892c77318ad887"}
2025-06-23T16:49:01.723+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766338, "tx_hash_count": 144}
2025-06-23T16:49:01.982+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766338", "tx_count": 144}
2025-06-23T16:49:01.984+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766338", "processed": 10, "total": 144}
2025-06-23T16:49:01.985+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766338", "processed": 20, "total": 144}
2025-06-23T16:49:01.985+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766338", "processed": 30, "total": 144}
2025-06-23T16:49:01.986+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766338", "processed": 40, "total": 144}
2025-06-23T16:49:01.986+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766338", "processed": 50, "total": 144}
2025-06-23T16:49:01.987+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766338", "processed": 60, "total": 144}
2025-06-23T16:49:01.987+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766338", "processed": 70, "total": 144}
2025-06-23T16:49:01.987+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766338", "processed": 80, "total": 144}
2025-06-23T16:49:01.988+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766338", "processed": 90, "total": 144}
2025-06-23T16:49:01.988+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766338", "processed": 100, "total": 144}
2025-06-23T16:49:01.989+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766338", "processed": 110, "total": 144}
2025-06-23T16:49:01.989+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766338", "processed": 120, "total": 144}
2025-06-23T16:49:01.990+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766338", "processed": 130, "total": 144}
2025-06-23T16:49:01.990+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766338", "processed": 140, "total": 144}
2025-06-23T16:49:01.990+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766338", "successful": 144}
2025-06-23T16:49:01.990+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766338, "count": 144}
2025-06-23T16:49:01.990+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766338}
2025-06-23T16:49:01.990+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766338, "transaction_count": 144}
2025-06-23T16:49:03.626+0700	WARN	service/crawler_service.go:466	Batch upsert failed	{"component": "crawler-service", "block_number": 22766338, "error": "bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +76 more errors...]", "transaction_count": 144, "duration": "1.635183583s"}
2025-06-23T16:49:03.626+0700	INFO	service/crawler_service.go:473	Falling back to batch insert	{"component": "crawler-service", "block_number": 22766338, "transaction_count": 144}
2025-06-23T16:49:04.432+0700	ERROR	service/crawler_service.go:478	Fallback batch insert also failed	{"component": "crawler-service", "block_number": 22766338, "error": "bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0x4c85b7d376b65f536740466cd9cb9aa42b2936cc171e1ae9ef9463ef08e3803d\" }]", "transaction_count": 144, "fallback_duration": "806.7025ms", "total_duration": "2.442023625s"}
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).saveTransactions
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:478
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).processBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:427
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).ProcessSpecificBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:363
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:219
2025-06-23T16:49:04.433+0700	ERROR	service/scheduler_service.go:220	Failed to process new block	{"component": "scheduler-service", "block_number": "22766338", "error": "failed to save transactions for block 22766338: both upsert and insert failed: upsert=bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +76 more errors...], insert=bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0x4c85b7d376b65f536740466cd9cb9aa42b2936cc171e1ae9ef9463ef08e3803d\" }]"}
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:220
2025-06-23T16:49:13.624+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:49:13.625+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766339"}
2025-06-23T16:49:13.625+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766339"}
2025-06-23T16:49:13.625+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766339"}
2025-06-23T16:49:13.625+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766339, "block_number": 22766339}
2025-06-23T16:49:13.625+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766339"}
2025-06-23T16:49:14.430+0700	INFO	service/crawler_service.go:397	Block already exists, skipping block save	{"component": "crawler-service", "block_number": 22766339, "block_hash": "0xa13209423fdfe7a6d76695814342a500258cce299c6fec452b545e7d4829bb28", "existing_hash": "0xa13209423fdfe7a6d76695814342a500258cce299c6fec452b545e7d4829bb28"}
2025-06-23T16:49:14.430+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766339, "tx_hash_count": 555}
2025-06-23T16:49:14.714+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766339", "tx_count": 555}
2025-06-23T16:49:14.715+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 10, "total": 555}
2025-06-23T16:49:14.715+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 20, "total": 555}
2025-06-23T16:49:14.716+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 30, "total": 555}
2025-06-23T16:49:14.716+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 40, "total": 555}
2025-06-23T16:49:14.716+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 50, "total": 555}
2025-06-23T16:49:14.717+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 60, "total": 555}
2025-06-23T16:49:14.717+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 70, "total": 555}
2025-06-23T16:49:14.718+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 80, "total": 555}
2025-06-23T16:49:14.718+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 90, "total": 555}
2025-06-23T16:49:14.718+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 100, "total": 555}
2025-06-23T16:49:14.719+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 110, "total": 555}
2025-06-23T16:49:14.719+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 120, "total": 555}
2025-06-23T16:49:14.719+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 130, "total": 555}
2025-06-23T16:49:14.720+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 140, "total": 555}
2025-06-23T16:49:14.720+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 150, "total": 555}
2025-06-23T16:49:14.721+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 160, "total": 555}
2025-06-23T16:49:14.721+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 170, "total": 555}
2025-06-23T16:49:14.721+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 180, "total": 555}
2025-06-23T16:49:14.722+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 190, "total": 555}
2025-06-23T16:49:14.722+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 200, "total": 555}
2025-06-23T16:49:14.723+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 210, "total": 555}
2025-06-23T16:49:14.724+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 220, "total": 555}
2025-06-23T16:49:14.724+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 230, "total": 555}
2025-06-23T16:49:14.724+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 240, "total": 555}
2025-06-23T16:49:14.725+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 250, "total": 555}
2025-06-23T16:49:14.725+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 260, "total": 555}
2025-06-23T16:49:14.725+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 270, "total": 555}
2025-06-23T16:49:14.726+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 280, "total": 555}
2025-06-23T16:49:14.726+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 290, "total": 555}
2025-06-23T16:49:14.726+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 300, "total": 555}
2025-06-23T16:49:14.727+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 310, "total": 555}
2025-06-23T16:49:14.727+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 320, "total": 555}
2025-06-23T16:49:14.728+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 330, "total": 555}
2025-06-23T16:49:14.728+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 340, "total": 555}
2025-06-23T16:49:14.728+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 350, "total": 555}
2025-06-23T16:49:14.729+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 360, "total": 555}
2025-06-23T16:49:14.729+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 370, "total": 555}
2025-06-23T16:49:14.729+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 380, "total": 555}
2025-06-23T16:49:14.730+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 390, "total": 555}
2025-06-23T16:49:14.730+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 400, "total": 555}
2025-06-23T16:49:14.730+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 410, "total": 555}
2025-06-23T16:49:14.731+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 420, "total": 555}
2025-06-23T16:49:14.731+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 430, "total": 555}
2025-06-23T16:49:14.732+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 440, "total": 555}
2025-06-23T16:49:14.732+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 450, "total": 555}
2025-06-23T16:49:14.732+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 460, "total": 555}
2025-06-23T16:49:14.733+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 470, "total": 555}
2025-06-23T16:49:14.733+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 480, "total": 555}
2025-06-23T16:49:14.733+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 490, "total": 555}
2025-06-23T16:49:14.734+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 500, "total": 555}
2025-06-23T16:49:14.734+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 510, "total": 555}
2025-06-23T16:49:14.734+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 520, "total": 555}
2025-06-23T16:49:14.735+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 530, "total": 555}
2025-06-23T16:49:14.735+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 540, "total": 555}
2025-06-23T16:49:14.736+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766339", "processed": 550, "total": 555}
2025-06-23T16:49:14.736+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766339", "successful": 555}
2025-06-23T16:49:14.736+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766339, "count": 555}
2025-06-23T16:49:14.736+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766339}
2025-06-23T16:49:14.736+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766339, "transaction_count": 555}
2025-06-23T16:49:18.397+0700	WARN	service/crawler_service.go:466	Batch upsert failed	{"component": "crawler-service", "block_number": 22766339, "error": "bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +529 more errors...]", "transaction_count": 555, "duration": "3.660351791s"}
2025-06-23T16:49:18.397+0700	INFO	service/crawler_service.go:473	Falling back to batch insert	{"component": "crawler-service", "block_number": 22766339, "transaction_count": 555}
2025-06-23T16:49:20.047+0700	ERROR	service/crawler_service.go:478	Fallback batch insert also failed	{"component": "crawler-service", "block_number": 22766339, "error": "bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0xebd8e69c5ceda44dc2b09df556d47f9ab8521cd515df34d43758f7d9bbac9de6\" }]", "transaction_count": 555, "fallback_duration": "1.649573041s", "total_duration": "5.310410666s"}
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).saveTransactions
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:478
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).processBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:427
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).ProcessSpecificBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:363
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:219
2025-06-23T16:49:20.048+0700	ERROR	service/scheduler_service.go:220	Failed to process new block	{"component": "scheduler-service", "block_number": "22766339", "error": "failed to save transactions for block 22766339: both upsert and insert failed: upsert=bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +529 more errors...], insert=bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0xebd8e69c5ceda44dc2b09df556d47f9ab8521cd515df34d43758f7d9bbac9de6\" }]"}
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:220
2025-06-23T16:49:25.656+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:49:25.656+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766340"}
2025-06-23T16:49:25.657+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766340"}
2025-06-23T16:49:25.657+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766340"}
2025-06-23T16:49:25.657+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766340, "block_number": 22766340}
2025-06-23T16:49:25.657+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766340"}
2025-06-23T16:49:26.135+0700	WARN	service/crawler_service.go:405	Block already exists (race condition), continuing	{"component": "crawler-service", "block_number": 22766340, "block_hash": "0xa9971f5f252d7aa6530c5b50baa9cc84657b7a3e80adf0f66dcf57a50cf0c7d3"}
2025-06-23T16:49:26.135+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766340, "tx_hash_count": 153}
2025-06-23T16:49:26.395+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766340", "tx_count": 153}
2025-06-23T16:49:26.395+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766340", "processed": 10, "total": 153}
2025-06-23T16:49:26.395+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766340", "processed": 20, "total": 153}
2025-06-23T16:49:26.396+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766340", "processed": 30, "total": 153}
2025-06-23T16:49:26.396+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766340", "processed": 40, "total": 153}
2025-06-23T16:49:26.397+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766340", "processed": 50, "total": 153}
2025-06-23T16:49:26.397+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766340", "processed": 60, "total": 153}
2025-06-23T16:49:26.397+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766340", "processed": 70, "total": 153}
2025-06-23T16:49:26.398+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766340", "processed": 80, "total": 153}
2025-06-23T16:49:26.398+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766340", "processed": 90, "total": 153}
2025-06-23T16:49:26.399+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766340", "processed": 100, "total": 153}
2025-06-23T16:49:26.399+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766340", "processed": 110, "total": 153}
2025-06-23T16:49:26.399+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766340", "processed": 120, "total": 153}
2025-06-23T16:49:26.400+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766340", "processed": 130, "total": 153}
2025-06-23T16:49:26.400+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766340", "processed": 140, "total": 153}
2025-06-23T16:49:26.401+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766340", "processed": 150, "total": 153}
2025-06-23T16:49:26.401+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766340", "successful": 153}
2025-06-23T16:49:26.401+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766340, "count": 153}
2025-06-23T16:49:26.401+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766340}
2025-06-23T16:49:26.401+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766340, "transaction_count": 153}
2025-06-23T16:49:26.790+0700	INFO	service/crawler_service.go:757	Health check completed	{"component": "crawler-service", "overall_status": "healthy", "message": "All systems operational", "total_time": "707.695834ms", "consecutive_failures": 0}
2025-06-23T16:49:26.936+0700	DEBUG	blockchain/websocket_scheduler.go:364	Sending WebSocket ping	{"component": "websocket-scheduler"}
2025-06-23T16:49:26.936+0700	DEBUG	blockchain/websocket_scheduler.go:374	WebSocket ping successful	{"component": "websocket-scheduler"}
2025-06-23T16:49:27.180+0700	DEBUG	service/crawler_service.go:497	Batch upsert succeeded	{"component": "crawler-service", "block_number": 22766340, "transaction_count": 153, "duration": "779.023292ms"}
2025-06-23T16:49:27.180+0700	INFO	service/crawler_service.go:430	Transactions saved to database	{"component": "crawler-service", "block_number": 22766340, "count": 153}
2025-06-23T16:49:28.011+0700	INFO	service/crawler_service.go:441	Block processed successfully	{"component": "crawler-service", "block_number": 22766340, "transaction_count": 153}
2025-06-23T16:49:37.181+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:49:37.183+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766341"}
2025-06-23T16:49:37.183+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766341"}
2025-06-23T16:49:37.183+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766341"}
2025-06-23T16:49:37.183+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766341, "block_number": 22766341}
2025-06-23T16:49:37.183+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766341"}
2025-06-23T16:49:37.781+0700	WARN	service/crawler_service.go:405	Block already exists (race condition), continuing	{"component": "crawler-service", "block_number": 22766341, "block_hash": "0xee2da021f1601e01e995a8fc162ea8630281c6b8a805799b6d266ce7ac4043a7"}
2025-06-23T16:49:37.781+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766341, "tx_hash_count": 225}
2025-06-23T16:49:38.294+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766341", "tx_count": 225}
2025-06-23T16:49:38.294+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 10, "total": 225}
2025-06-23T16:49:38.295+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 20, "total": 225}
2025-06-23T16:49:38.295+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 30, "total": 225}
2025-06-23T16:49:38.295+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 40, "total": 225}
2025-06-23T16:49:38.296+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 50, "total": 225}
2025-06-23T16:49:38.296+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 60, "total": 225}
2025-06-23T16:49:38.297+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 70, "total": 225}
2025-06-23T16:49:38.297+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 80, "total": 225}
2025-06-23T16:49:38.297+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 90, "total": 225}
2025-06-23T16:49:38.298+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 100, "total": 225}
2025-06-23T16:49:38.298+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 110, "total": 225}
2025-06-23T16:49:38.298+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 120, "total": 225}
2025-06-23T16:49:38.299+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 130, "total": 225}
2025-06-23T16:49:38.299+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 140, "total": 225}
2025-06-23T16:49:38.300+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 150, "total": 225}
2025-06-23T16:49:38.300+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 160, "total": 225}
2025-06-23T16:49:38.300+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 170, "total": 225}
2025-06-23T16:49:38.301+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 180, "total": 225}
2025-06-23T16:49:38.301+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 190, "total": 225}
2025-06-23T16:49:38.301+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 200, "total": 225}
2025-06-23T16:49:38.302+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 210, "total": 225}
2025-06-23T16:49:38.302+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766341", "processed": 220, "total": 225}
2025-06-23T16:49:38.302+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766341", "successful": 225}
2025-06-23T16:49:38.302+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766341, "count": 225}
2025-06-23T16:49:38.302+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766341}
2025-06-23T16:49:38.302+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766341, "transaction_count": 225}
2025-06-23T16:49:39.720+0700	WARN	service/crawler_service.go:466	Batch upsert failed	{"component": "crawler-service", "block_number": 22766341, "error": "bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +199 more errors...]", "transaction_count": 225, "duration": "1.418050667s"}
2025-06-23T16:49:39.721+0700	INFO	service/crawler_service.go:473	Falling back to batch insert	{"component": "crawler-service", "block_number": 22766341, "transaction_count": 225}
2025-06-23T16:49:41.555+0700	ERROR	service/crawler_service.go:478	Fallback batch insert also failed	{"component": "crawler-service", "block_number": 22766341, "error": "bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0x7e773a90cfc1cf101b981f78b58f00e81bbec1f18e0079ad04328bdb5c9289a6\" }]", "transaction_count": 225, "fallback_duration": "1.834397583s", "total_duration": "3.252525709s"}
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).saveTransactions
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:478
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).processBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:427
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).ProcessSpecificBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:363
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:219
2025-06-23T16:49:41.555+0700	ERROR	service/scheduler_service.go:220	Failed to process new block	{"component": "scheduler-service", "block_number": "22766341", "error": "failed to save transactions for block 22766341: both upsert and insert failed: upsert=bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +199 more errors...], insert=bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0x7e773a90cfc1cf101b981f78b58f00e81bbec1f18e0079ad04328bdb5c9289a6\" }]"}
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:220
2025-06-23T16:49:48.952+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:49:48.955+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766342"}
2025-06-23T16:49:48.955+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766342"}
2025-06-23T16:49:48.955+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766342"}
2025-06-23T16:49:48.955+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766342, "block_number": 22766342}
2025-06-23T16:49:48.955+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766342"}
2025-06-23T16:49:49.574+0700	WARN	service/crawler_service.go:405	Block already exists (race condition), continuing	{"component": "crawler-service", "block_number": 22766342, "block_hash": "0xb2ba4b268c94219169ff074121f9ed191752998e738e74ee5a82e5805797c7ec"}
2025-06-23T16:49:49.575+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766342, "tx_hash_count": 230}
2025-06-23T16:49:49.861+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766342", "tx_count": 230}
2025-06-23T16:49:49.862+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 10, "total": 230}
2025-06-23T16:49:49.862+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 20, "total": 230}
2025-06-23T16:49:49.864+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 30, "total": 230}
2025-06-23T16:49:49.864+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 40, "total": 230}
2025-06-23T16:49:49.865+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 50, "total": 230}
2025-06-23T16:49:49.866+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 60, "total": 230}
2025-06-23T16:49:49.866+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 70, "total": 230}
2025-06-23T16:49:49.866+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 80, "total": 230}
2025-06-23T16:49:49.867+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 90, "total": 230}
2025-06-23T16:49:49.868+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 100, "total": 230}
2025-06-23T16:49:49.869+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 110, "total": 230}
2025-06-23T16:49:49.871+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 120, "total": 230}
2025-06-23T16:49:49.871+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 130, "total": 230}
2025-06-23T16:49:49.872+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 140, "total": 230}
2025-06-23T16:49:49.873+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 150, "total": 230}
2025-06-23T16:49:49.874+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 160, "total": 230}
2025-06-23T16:49:49.874+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 170, "total": 230}
2025-06-23T16:49:49.875+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 180, "total": 230}
2025-06-23T16:49:49.875+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 190, "total": 230}
2025-06-23T16:49:49.875+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 200, "total": 230}
2025-06-23T16:49:49.876+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 210, "total": 230}
2025-06-23T16:49:49.876+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 220, "total": 230}
2025-06-23T16:49:49.877+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766342", "processed": 230, "total": 230}
2025-06-23T16:49:49.877+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766342", "successful": 230}
2025-06-23T16:49:49.877+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766342, "count": 230}
2025-06-23T16:49:49.877+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766342}
2025-06-23T16:49:49.877+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766342, "transaction_count": 230}
2025-06-23T16:49:51.794+0700	WARN	service/crawler_service.go:466	Batch upsert failed	{"component": "crawler-service", "block_number": 22766342, "error": "bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +203 more errors...]", "transaction_count": 230, "duration": "1.916961208s"}
2025-06-23T16:49:51.794+0700	INFO	service/crawler_service.go:473	Falling back to batch insert	{"component": "crawler-service", "block_number": 22766342, "transaction_count": 230}
2025-06-23T16:49:53.354+0700	ERROR	service/crawler_service.go:478	Fallback batch insert also failed	{"component": "crawler-service", "block_number": 22766342, "error": "bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0x765df6c598e2cbfce085edcd1a85052a6ed6d721209e912a65d2ff1680e49adb\" }]", "transaction_count": 230, "fallback_duration": "1.559814667s", "total_duration": "3.476867917s"}
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).saveTransactions
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:478
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).processBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:427
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).ProcessSpecificBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:363
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:219
2025-06-23T16:49:53.354+0700	ERROR	service/scheduler_service.go:220	Failed to process new block	{"component": "scheduler-service", "block_number": "22766342", "error": "failed to save transactions for block 22766342: both upsert and insert failed: upsert=bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +203 more errors...], insert=bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0x765df6c598e2cbfce085edcd1a85052a6ed6d721209e912a65d2ff1680e49adb\" }]"}
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:220
2025-06-23T16:49:56.656+0700	INFO	service/crawler_service.go:757	Health check completed	{"component": "crawler-service", "overall_status": "healthy", "message": "All systems operational", "total_time": "572.555084ms", "consecutive_failures": 0}
2025-06-23T16:49:56.936+0700	DEBUG	blockchain/websocket_scheduler.go:364	Sending WebSocket ping	{"component": "websocket-scheduler"}
2025-06-23T16:49:56.938+0700	DEBUG	blockchain/websocket_scheduler.go:374	WebSocket ping successful	{"component": "websocket-scheduler"}
2025-06-23T16:50:01.201+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:50:01.202+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766343"}
2025-06-23T16:50:01.202+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766343"}
2025-06-23T16:50:01.202+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766343"}
2025-06-23T16:50:01.202+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766343, "block_number": 22766343}
2025-06-23T16:50:01.202+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766343"}
2025-06-23T16:50:01.699+0700	INFO	service/crawler_service.go:412	Block saved to database	{"component": "crawler-service", "block_number": 22766343}
2025-06-23T16:50:01.699+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766343, "tx_hash_count": 218}
2025-06-23T16:50:01.954+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766343", "tx_count": 218}
2025-06-23T16:50:01.954+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 10, "total": 218}
2025-06-23T16:50:01.955+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 20, "total": 218}
2025-06-23T16:50:01.955+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 30, "total": 218}
2025-06-23T16:50:01.955+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 40, "total": 218}
2025-06-23T16:50:01.956+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 50, "total": 218}
2025-06-23T16:50:01.956+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 60, "total": 218}
2025-06-23T16:50:01.957+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 70, "total": 218}
2025-06-23T16:50:01.957+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 80, "total": 218}
2025-06-23T16:50:01.957+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 90, "total": 218}
2025-06-23T16:50:01.958+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 100, "total": 218}
2025-06-23T16:50:01.958+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 110, "total": 218}
2025-06-23T16:50:01.959+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 120, "total": 218}
2025-06-23T16:50:01.959+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 130, "total": 218}
2025-06-23T16:50:01.959+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 140, "total": 218}
2025-06-23T16:50:01.960+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 150, "total": 218}
2025-06-23T16:50:01.960+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 160, "total": 218}
2025-06-23T16:50:01.960+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 170, "total": 218}
2025-06-23T16:50:01.961+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 180, "total": 218}
2025-06-23T16:50:01.961+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 190, "total": 218}
2025-06-23T16:50:01.962+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 200, "total": 218}
2025-06-23T16:50:01.962+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766343", "processed": 210, "total": 218}
2025-06-23T16:50:01.962+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766343", "successful": 218}
2025-06-23T16:50:01.962+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766343, "count": 218}
2025-06-23T16:50:01.962+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766343}
2025-06-23T16:50:01.962+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766343, "transaction_count": 218}
2025-06-23T16:50:03.953+0700	WARN	service/crawler_service.go:466	Batch upsert failed	{"component": "crawler-service", "block_number": 22766343, "error": "bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +76 more errors...]", "transaction_count": 218, "duration": "1.990755959s"}
2025-06-23T16:50:03.953+0700	INFO	service/crawler_service.go:473	Falling back to batch insert	{"component": "crawler-service", "block_number": 22766343, "transaction_count": 218}
2025-06-23T16:50:04.462+0700	ERROR	service/crawler_service.go:478	Fallback batch insert also failed	{"component": "crawler-service", "block_number": 22766343, "error": "bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0x02ed185883cf5f510d89f6a147b40cb7144e5643e8a28e4fe5a1afdb53c2a273\" }]", "transaction_count": 218, "fallback_duration": "508.277333ms", "total_duration": "2.499203917s"}
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).saveTransactions
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:478
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).processBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:427
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).ProcessSpecificBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:363
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:219
2025-06-23T16:50:04.462+0700	ERROR	service/scheduler_service.go:220	Failed to process new block	{"component": "scheduler-service", "block_number": "22766343", "error": "failed to save transactions for block 22766343: both upsert and insert failed: upsert=bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +76 more errors...], insert=bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0x02ed185883cf5f510d89f6a147b40cb7144e5643e8a28e4fe5a1afdb53c2a273\" }]"}
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:220
2025-06-23T16:50:13.360+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:50:13.361+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766344"}
2025-06-23T16:50:13.362+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766344"}
2025-06-23T16:50:13.362+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766344"}
2025-06-23T16:50:13.362+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766344, "block_number": 22766344}
2025-06-23T16:50:13.362+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766344"}
2025-06-23T16:50:13.830+0700	WARN	service/crawler_service.go:405	Block already exists (race condition), continuing	{"component": "crawler-service", "block_number": 22766344, "block_hash": "0xf71dc059d9789c7d37cfa782ccc02ec85cd553a94dad75a2c2e41d1f91530136"}
2025-06-23T16:50:13.830+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766344, "tx_hash_count": 170}
2025-06-23T16:50:14.088+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766344", "tx_count": 170}
2025-06-23T16:50:14.089+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 10, "total": 170}
2025-06-23T16:50:14.089+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 20, "total": 170}
2025-06-23T16:50:14.090+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 30, "total": 170}
2025-06-23T16:50:14.090+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 40, "total": 170}
2025-06-23T16:50:14.091+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 50, "total": 170}
2025-06-23T16:50:14.091+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 60, "total": 170}
2025-06-23T16:50:14.091+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 70, "total": 170}
2025-06-23T16:50:14.092+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 80, "total": 170}
2025-06-23T16:50:14.092+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 90, "total": 170}
2025-06-23T16:50:14.093+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 100, "total": 170}
2025-06-23T16:50:14.094+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 110, "total": 170}
2025-06-23T16:50:14.094+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 120, "total": 170}
2025-06-23T16:50:14.094+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 130, "total": 170}
2025-06-23T16:50:14.095+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 140, "total": 170}
2025-06-23T16:50:14.095+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 150, "total": 170}
2025-06-23T16:50:14.096+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 160, "total": 170}
2025-06-23T16:50:14.096+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766344", "processed": 170, "total": 170}
2025-06-23T16:50:14.096+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766344", "successful": 170}
2025-06-23T16:50:14.096+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766344, "count": 170}
2025-06-23T16:50:14.096+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766344}
2025-06-23T16:50:14.096+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766344, "transaction_count": 170}
2025-06-23T16:50:15.015+0700	WARN	service/crawler_service.go:466	Batch upsert failed	{"component": "crawler-service", "block_number": 22766344, "error": "bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +6 more errors...]", "transaction_count": 170, "duration": "918.371041ms"}
2025-06-23T16:50:15.015+0700	INFO	service/crawler_service.go:473	Falling back to batch insert	{"component": "crawler-service", "block_number": 22766344, "transaction_count": 170}
2025-06-23T16:50:15.728+0700	ERROR	service/crawler_service.go:478	Fallback batch insert also failed	{"component": "crawler-service", "block_number": 22766344, "error": "bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0x35bb8dd7c2d4b55e793591b0de2773b04b70b45969776eecaed359d07a493ae9\" }]", "transaction_count": 170, "fallback_duration": "712.91175ms", "total_duration": "1.631658833s"}
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).saveTransactions
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:478
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).processBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:427
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).ProcessSpecificBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:363
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:219
2025-06-23T16:50:15.728+0700	ERROR	service/scheduler_service.go:220	Failed to process new block	{"component": "scheduler-service", "block_number": "22766344", "error": "failed to save transactions for block 22766344: both upsert and insert failed: upsert=bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +6 more errors...], insert=bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0x35bb8dd7c2d4b55e793591b0de2773b04b70b45969776eecaed359d07a493ae9\" }]"}
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:220
2025-06-23T16:50:26.114+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:50:26.114+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766345"}
2025-06-23T16:50:26.114+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766345"}
2025-06-23T16:50:26.114+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766345"}
2025-06-23T16:50:26.114+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766345, "block_number": 22766345}
2025-06-23T16:50:26.114+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766345"}
2025-06-23T16:50:26.651+0700	INFO	service/crawler_service.go:757	Health check completed	{"component": "crawler-service", "overall_status": "healthy", "message": "All systems operational", "total_time": "569.066167ms", "consecutive_failures": 0}
2025-06-23T16:50:26.694+0700	WARN	service/crawler_service.go:405	Block already exists (race condition), continuing	{"component": "crawler-service", "block_number": 22766345, "block_hash": "0x75fd39a33bea6bddae0ad6b831759311df0d8476ef901811fb7fa92c4664540a"}
2025-06-23T16:50:26.694+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766345, "tx_hash_count": 384}
2025-06-23T16:50:26.935+0700	DEBUG	blockchain/websocket_scheduler.go:364	Sending WebSocket ping	{"component": "websocket-scheduler"}
2025-06-23T16:50:26.935+0700	DEBUG	blockchain/websocket_scheduler.go:374	WebSocket ping successful	{"component": "websocket-scheduler"}
2025-06-23T16:50:26.955+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766345", "tx_count": 384}
2025-06-23T16:50:26.956+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 10, "total": 384}
2025-06-23T16:50:26.956+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 20, "total": 384}
2025-06-23T16:50:26.956+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 30, "total": 384}
2025-06-23T16:50:26.957+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 40, "total": 384}
2025-06-23T16:50:26.957+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 50, "total": 384}
2025-06-23T16:50:26.957+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 60, "total": 384}
2025-06-23T16:50:26.958+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 70, "total": 384}
2025-06-23T16:50:26.958+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 80, "total": 384}
2025-06-23T16:50:26.959+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 90, "total": 384}
2025-06-23T16:50:26.959+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 100, "total": 384}
2025-06-23T16:50:26.960+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 110, "total": 384}
2025-06-23T16:50:26.960+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 120, "total": 384}
2025-06-23T16:50:26.960+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 130, "total": 384}
2025-06-23T16:50:26.961+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 140, "total": 384}
2025-06-23T16:50:26.961+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 150, "total": 384}
2025-06-23T16:50:26.961+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 160, "total": 384}
2025-06-23T16:50:26.962+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 170, "total": 384}
2025-06-23T16:50:26.962+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 180, "total": 384}
2025-06-23T16:50:26.963+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 190, "total": 384}
2025-06-23T16:50:26.963+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 200, "total": 384}
2025-06-23T16:50:26.963+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 210, "total": 384}
2025-06-23T16:50:26.964+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 220, "total": 384}
2025-06-23T16:50:26.965+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 230, "total": 384}
2025-06-23T16:50:26.965+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 240, "total": 384}
2025-06-23T16:50:26.966+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 250, "total": 384}
2025-06-23T16:50:26.967+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 260, "total": 384}
2025-06-23T16:50:26.967+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 270, "total": 384}
2025-06-23T16:50:26.968+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 280, "total": 384}
2025-06-23T16:50:26.968+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 290, "total": 384}
2025-06-23T16:50:26.969+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 300, "total": 384}
2025-06-23T16:50:26.969+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 310, "total": 384}
2025-06-23T16:50:26.969+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 320, "total": 384}
2025-06-23T16:50:26.970+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 330, "total": 384}
2025-06-23T16:50:26.970+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 340, "total": 384}
2025-06-23T16:50:26.970+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 350, "total": 384}
2025-06-23T16:50:26.971+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 360, "total": 384}
2025-06-23T16:50:26.971+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 370, "total": 384}
2025-06-23T16:50:26.972+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766345", "processed": 380, "total": 384}
2025-06-23T16:50:26.972+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766345", "successful": 384}
2025-06-23T16:50:26.972+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766345, "count": 384}
2025-06-23T16:50:26.972+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766345}
2025-06-23T16:50:26.972+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766345, "transaction_count": 384}
2025-06-23T16:50:29.128+0700	WARN	service/crawler_service.go:466	Batch upsert failed	{"component": "crawler-service", "block_number": 22766345, "error": "bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +151 more errors...]", "transaction_count": 384, "duration": "2.156054625s"}
2025-06-23T16:50:29.128+0700	INFO	service/crawler_service.go:473	Falling back to batch insert	{"component": "crawler-service", "block_number": 22766345, "transaction_count": 384}
2025-06-23T16:50:29.502+0700	ERROR	service/crawler_service.go:478	Fallback batch insert also failed	{"component": "crawler-service", "block_number": 22766345, "error": "bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0xdc0e56082b98d4fe076adb2c221bbd9e19ee5a1509d9740fea2b60e7b57551ad\" }]", "transaction_count": 384, "fallback_duration": "373.922083ms", "total_duration": "2.530057583s"}
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).saveTransactions
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:478
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).processBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:427
ethereum-raw-data-crawler/internal/application/service.(*CrawlerService).ProcessSpecificBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/crawler_service.go:363
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:219
2025-06-23T16:50:29.502+0700	ERROR	service/scheduler_service.go:220	Failed to process new block	{"component": "scheduler-service", "block_number": "22766345", "error": "failed to save transactions for block 22766345: both upsert and insert failed: upsert=bulk write exception: write errors: [Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', Performing an update on the path '_id' would modify the immutable field '_id', +151 more errors...], insert=bulk write exception: write errors: [E11000 duplicate key error collection: ethereum_raw_data.transactions index: hash_1 dup key: { hash: \"0xdc0e56082b98d4fe076adb2c221bbd9e19ee5a1509d9740fea2b60e7b57551ad\" }]"}
ethereum-raw-data-crawler/internal/application/service.(*SchedulerService).handleNewBlock
	/Users/mac/Github/haitranwang/HoiAnHub/ethereum-raw-data-crawler/internal/application/service/scheduler_service.go:220
2025-06-23T16:50:37.377+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:50:37.377+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766346"}
2025-06-23T16:50:37.377+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766346"}
2025-06-23T16:50:37.377+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766346"}
2025-06-23T16:50:37.377+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766346, "block_number": 22766346}
2025-06-23T16:50:37.377+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766346"}
2025-06-23T16:50:37.838+0700	INFO	service/crawler_service.go:412	Block saved to database	{"component": "crawler-service", "block_number": 22766346}
2025-06-23T16:50:37.838+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766346, "tx_hash_count": 149}
2025-06-23T16:50:38.117+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766346", "tx_count": 149}
2025-06-23T16:50:38.118+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766346", "processed": 10, "total": 149}
2025-06-23T16:50:38.118+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766346", "processed": 20, "total": 149}
2025-06-23T16:50:38.119+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766346", "processed": 30, "total": 149}
2025-06-23T16:50:38.119+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766346", "processed": 40, "total": 149}
2025-06-23T16:50:38.119+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766346", "processed": 50, "total": 149}
2025-06-23T16:50:38.120+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766346", "processed": 60, "total": 149}
2025-06-23T16:50:38.120+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766346", "processed": 70, "total": 149}
2025-06-23T16:50:38.121+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766346", "processed": 80, "total": 149}
2025-06-23T16:50:38.121+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766346", "processed": 90, "total": 149}
2025-06-23T16:50:38.121+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766346", "processed": 100, "total": 149}
2025-06-23T16:50:38.122+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766346", "processed": 110, "total": 149}
2025-06-23T16:50:38.122+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766346", "processed": 120, "total": 149}
2025-06-23T16:50:38.122+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766346", "processed": 130, "total": 149}
2025-06-23T16:50:38.123+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766346", "processed": 140, "total": 149}
2025-06-23T16:50:38.123+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766346", "successful": 149}
2025-06-23T16:50:38.123+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766346, "count": 149}
2025-06-23T16:50:38.123+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766346}
2025-06-23T16:50:38.123+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766346, "transaction_count": 149}
2025-06-23T16:50:39.789+0700	DEBUG	service/crawler_service.go:497	Batch upsert succeeded	{"component": "crawler-service", "block_number": 22766346, "transaction_count": 149, "duration": "1.66531225s"}
2025-06-23T16:50:39.789+0700	INFO	service/crawler_service.go:430	Transactions saved to database	{"component": "crawler-service", "block_number": 22766346, "count": 149}
2025-06-23T16:50:39.905+0700	INFO	service/crawler_service.go:441	Block processed successfully	{"component": "crawler-service", "block_number": 22766346, "transaction_count": 149}
2025-06-23T16:50:49.300+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:50:49.307+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766347"}
2025-06-23T16:50:49.307+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766347"}
2025-06-23T16:50:49.307+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766347"}
2025-06-23T16:50:49.307+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766347, "block_number": 22766347}
2025-06-23T16:50:49.307+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766347"}
2025-06-23T16:50:49.904+0700	INFO	service/crawler_service.go:412	Block saved to database	{"component": "crawler-service", "block_number": 22766347}
2025-06-23T16:50:49.904+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766347, "tx_hash_count": 235}
2025-06-23T16:50:50.159+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766347", "tx_count": 235}
2025-06-23T16:50:50.160+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 10, "total": 235}
2025-06-23T16:50:50.160+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 20, "total": 235}
2025-06-23T16:50:50.160+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 30, "total": 235}
2025-06-23T16:50:50.161+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 40, "total": 235}
2025-06-23T16:50:50.161+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 50, "total": 235}
2025-06-23T16:50:50.161+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 60, "total": 235}
2025-06-23T16:50:50.162+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 70, "total": 235}
2025-06-23T16:50:50.163+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 80, "total": 235}
2025-06-23T16:50:50.163+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 90, "total": 235}
2025-06-23T16:50:50.164+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 100, "total": 235}
2025-06-23T16:50:50.165+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 110, "total": 235}
2025-06-23T16:50:50.165+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 120, "total": 235}
2025-06-23T16:50:50.165+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 130, "total": 235}
2025-06-23T16:50:50.166+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 140, "total": 235}
2025-06-23T16:50:50.166+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 150, "total": 235}
2025-06-23T16:50:50.167+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 160, "total": 235}
2025-06-23T16:50:50.167+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 170, "total": 235}
2025-06-23T16:50:50.167+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 180, "total": 235}
2025-06-23T16:50:50.168+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 190, "total": 235}
2025-06-23T16:50:50.168+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 200, "total": 235}
2025-06-23T16:50:50.168+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 210, "total": 235}
2025-06-23T16:50:50.169+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 220, "total": 235}
2025-06-23T16:50:50.169+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766347", "processed": 230, "total": 235}
2025-06-23T16:50:50.169+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766347", "successful": 235}
2025-06-23T16:50:50.169+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766347, "count": 235}
2025-06-23T16:50:50.169+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766347}
2025-06-23T16:50:50.170+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766347, "transaction_count": 235}
2025-06-23T16:50:51.122+0700	DEBUG	service/crawler_service.go:497	Batch upsert succeeded	{"component": "crawler-service", "block_number": 22766347, "transaction_count": 235, "duration": "952.483167ms"}
2025-06-23T16:50:51.122+0700	INFO	service/crawler_service.go:430	Transactions saved to database	{"component": "crawler-service", "block_number": 22766347, "count": 235}
2025-06-23T16:50:51.239+0700	INFO	service/crawler_service.go:441	Block processed successfully	{"component": "crawler-service", "block_number": 22766347, "transaction_count": 235}
2025-06-23T16:50:56.680+0700	INFO	service/crawler_service.go:757	Health check completed	{"component": "crawler-service", "overall_status": "healthy", "message": "All systems operational", "total_time": "596.09725ms", "consecutive_failures": 0}
2025-06-23T16:50:56.937+0700	DEBUG	blockchain/websocket_scheduler.go:364	Sending WebSocket ping	{"component": "websocket-scheduler"}
2025-06-23T16:50:56.937+0700	DEBUG	blockchain/websocket_scheduler.go:374	WebSocket ping successful	{"component": "websocket-scheduler"}
2025-06-23T16:51:01.510+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:51:01.510+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766348"}
2025-06-23T16:51:01.510+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766348"}
2025-06-23T16:51:01.510+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766348"}
2025-06-23T16:51:01.510+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766348, "block_number": 22766348}
2025-06-23T16:51:01.510+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766348"}
2025-06-23T16:51:02.064+0700	INFO	service/crawler_service.go:412	Block saved to database	{"component": "crawler-service", "block_number": 22766348}
2025-06-23T16:51:02.065+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766348, "tx_hash_count": 191}
2025-06-23T16:51:02.325+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766348", "tx_count": 191}
2025-06-23T16:51:02.325+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 10, "total": 191}
2025-06-23T16:51:02.326+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 20, "total": 191}
2025-06-23T16:51:02.326+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 30, "total": 191}
2025-06-23T16:51:02.327+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 40, "total": 191}
2025-06-23T16:51:02.327+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 50, "total": 191}
2025-06-23T16:51:02.327+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 60, "total": 191}
2025-06-23T16:51:02.328+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 70, "total": 191}
2025-06-23T16:51:02.328+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 80, "total": 191}
2025-06-23T16:51:02.329+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 90, "total": 191}
2025-06-23T16:51:02.329+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 100, "total": 191}
2025-06-23T16:51:02.330+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 110, "total": 191}
2025-06-23T16:51:02.330+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 120, "total": 191}
2025-06-23T16:51:02.331+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 130, "total": 191}
2025-06-23T16:51:02.331+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 140, "total": 191}
2025-06-23T16:51:02.331+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 150, "total": 191}
2025-06-23T16:51:02.332+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 160, "total": 191}
2025-06-23T16:51:02.332+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 170, "total": 191}
2025-06-23T16:51:02.332+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 180, "total": 191}
2025-06-23T16:51:02.333+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766348", "processed": 190, "total": 191}
2025-06-23T16:51:02.333+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766348", "successful": 191}
2025-06-23T16:51:02.333+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766348, "count": 191}
2025-06-23T16:51:02.333+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766348}
2025-06-23T16:51:02.333+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766348, "transaction_count": 191}
2025-06-23T16:51:03.840+0700	DEBUG	service/crawler_service.go:497	Batch upsert succeeded	{"component": "crawler-service", "block_number": 22766348, "transaction_count": 191, "duration": "1.507415583s"}
2025-06-23T16:51:03.841+0700	INFO	service/crawler_service.go:430	Transactions saved to database	{"component": "crawler-service", "block_number": 22766348, "count": 191}
2025-06-23T16:51:03.949+0700	INFO	service/crawler_service.go:441	Block processed successfully	{"component": "crawler-service", "block_number": 22766348, "transaction_count": 191}
2025-06-23T16:51:13.823+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:51:13.824+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766349"}
2025-06-23T16:51:13.824+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766349"}
2025-06-23T16:51:13.824+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766349"}
2025-06-23T16:51:13.824+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766349, "block_number": 22766349}
2025-06-23T16:51:13.824+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766349"}
2025-06-23T16:51:14.521+0700	INFO	service/crawler_service.go:412	Block saved to database	{"component": "crawler-service", "block_number": 22766349}
2025-06-23T16:51:14.521+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766349, "tx_hash_count": 245}
2025-06-23T16:51:14.810+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766349", "tx_count": 245}
2025-06-23T16:51:14.811+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 10, "total": 245}
2025-06-23T16:51:14.811+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 20, "total": 245}
2025-06-23T16:51:14.812+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 30, "total": 245}
2025-06-23T16:51:14.812+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 40, "total": 245}
2025-06-23T16:51:14.813+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 50, "total": 245}
2025-06-23T16:51:14.814+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 60, "total": 245}
2025-06-23T16:51:14.814+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 70, "total": 245}
2025-06-23T16:51:14.814+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 80, "total": 245}
2025-06-23T16:51:14.815+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 90, "total": 245}
2025-06-23T16:51:14.815+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 100, "total": 245}
2025-06-23T16:51:14.816+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 110, "total": 245}
2025-06-23T16:51:14.816+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 120, "total": 245}
2025-06-23T16:51:14.816+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 130, "total": 245}
2025-06-23T16:51:14.817+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 140, "total": 245}
2025-06-23T16:51:14.817+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 150, "total": 245}
2025-06-23T16:51:14.818+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 160, "total": 245}
2025-06-23T16:51:14.818+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 170, "total": 245}
2025-06-23T16:51:14.818+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 180, "total": 245}
2025-06-23T16:51:14.819+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 190, "total": 245}
2025-06-23T16:51:14.819+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 200, "total": 245}
2025-06-23T16:51:14.820+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 210, "total": 245}
2025-06-23T16:51:14.820+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 220, "total": 245}
2025-06-23T16:51:14.820+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 230, "total": 245}
2025-06-23T16:51:14.821+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766349", "processed": 240, "total": 245}
2025-06-23T16:51:14.821+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766349", "successful": 245}
2025-06-23T16:51:14.821+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766349, "count": 245}
2025-06-23T16:51:14.821+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766349}
2025-06-23T16:51:14.821+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766349, "transaction_count": 245}
2025-06-23T16:51:16.695+0700	DEBUG	service/crawler_service.go:497	Batch upsert succeeded	{"component": "crawler-service", "block_number": 22766349, "transaction_count": 245, "duration": "1.874632125s"}
2025-06-23T16:51:16.696+0700	INFO	service/crawler_service.go:430	Transactions saved to database	{"component": "crawler-service", "block_number": 22766349, "count": 245}
2025-06-23T16:51:16.792+0700	INFO	service/crawler_service.go:441	Block processed successfully	{"component": "crawler-service", "block_number": 22766349, "transaction_count": 245}
2025-06-23T16:51:25.567+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:51:25.568+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766350"}
2025-06-23T16:51:25.568+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766350"}
2025-06-23T16:51:25.568+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766350"}
2025-06-23T16:51:25.568+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766350, "block_number": 22766350}
2025-06-23T16:51:25.568+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766350"}
2025-06-23T16:51:26.074+0700	INFO	service/crawler_service.go:412	Block saved to database	{"component": "crawler-service", "block_number": 22766350}
2025-06-23T16:51:26.074+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766350, "tx_hash_count": 183}
2025-06-23T16:51:26.329+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766350", "tx_count": 183}
2025-06-23T16:51:26.330+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 10, "total": 183}
2025-06-23T16:51:26.330+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 20, "total": 183}
2025-06-23T16:51:26.331+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 30, "total": 183}
2025-06-23T16:51:26.331+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 40, "total": 183}
2025-06-23T16:51:26.332+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 50, "total": 183}
2025-06-23T16:51:26.332+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 60, "total": 183}
2025-06-23T16:51:26.333+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 70, "total": 183}
2025-06-23T16:51:26.333+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 80, "total": 183}
2025-06-23T16:51:26.333+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 90, "total": 183}
2025-06-23T16:51:26.334+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 100, "total": 183}
2025-06-23T16:51:26.334+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 110, "total": 183}
2025-06-23T16:51:26.335+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 120, "total": 183}
2025-06-23T16:51:26.335+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 130, "total": 183}
2025-06-23T16:51:26.335+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 140, "total": 183}
2025-06-23T16:51:26.336+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 150, "total": 183}
2025-06-23T16:51:26.336+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 160, "total": 183}
2025-06-23T16:51:26.336+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 170, "total": 183}
2025-06-23T16:51:26.337+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766350", "processed": 180, "total": 183}
2025-06-23T16:51:26.337+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766350", "successful": 183}
2025-06-23T16:51:26.337+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766350, "count": 183}
2025-06-23T16:51:26.337+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766350}
2025-06-23T16:51:26.337+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766350, "transaction_count": 183}
2025-06-23T16:51:26.942+0700	DEBUG	blockchain/websocket_scheduler.go:364	Sending WebSocket ping	{"component": "websocket-scheduler"}
2025-06-23T16:51:26.942+0700	DEBUG	blockchain/websocket_scheduler.go:374	WebSocket ping successful	{"component": "websocket-scheduler"}
2025-06-23T16:51:26.980+0700	INFO	service/crawler_service.go:757	Health check completed	{"component": "crawler-service", "overall_status": "healthy", "message": "All systems operational", "total_time": "897.3285ms", "consecutive_failures": 0}
2025-06-23T16:51:27.245+0700	DEBUG	service/crawler_service.go:497	Batch upsert succeeded	{"component": "crawler-service", "block_number": 22766350, "transaction_count": 183, "duration": "908.253959ms"}
2025-06-23T16:51:27.245+0700	INFO	service/crawler_service.go:430	Transactions saved to database	{"component": "crawler-service", "block_number": 22766350, "count": 183}
2025-06-23T16:51:27.350+0700	INFO	service/crawler_service.go:441	Block processed successfully	{"component": "crawler-service", "block_number": 22766350, "transaction_count": 183}
2025-06-23T16:51:38.526+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:51:38.526+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766351"}
2025-06-23T16:51:38.527+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766351"}
2025-06-23T16:51:38.527+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766351"}
2025-06-23T16:51:38.527+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766351, "block_number": 22766351}
2025-06-23T16:51:38.527+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766351"}
2025-06-23T16:51:39.093+0700	INFO	service/crawler_service.go:412	Block saved to database	{"component": "crawler-service", "block_number": 22766351}
2025-06-23T16:51:39.093+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766351, "tx_hash_count": 194}
2025-06-23T16:51:39.354+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766351", "tx_count": 194}
2025-06-23T16:51:39.354+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 10, "total": 194}
2025-06-23T16:51:39.355+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 20, "total": 194}
2025-06-23T16:51:39.355+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 30, "total": 194}
2025-06-23T16:51:39.355+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 40, "total": 194}
2025-06-23T16:51:39.356+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 50, "total": 194}
2025-06-23T16:51:39.356+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 60, "total": 194}
2025-06-23T16:51:39.357+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 70, "total": 194}
2025-06-23T16:51:39.357+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 80, "total": 194}
2025-06-23T16:51:39.357+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 90, "total": 194}
2025-06-23T16:51:39.358+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 100, "total": 194}
2025-06-23T16:51:39.358+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 110, "total": 194}
2025-06-23T16:51:39.359+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 120, "total": 194}
2025-06-23T16:51:39.359+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 130, "total": 194}
2025-06-23T16:51:39.359+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 140, "total": 194}
2025-06-23T16:51:39.360+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 150, "total": 194}
2025-06-23T16:51:39.360+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 160, "total": 194}
2025-06-23T16:51:39.361+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 170, "total": 194}
2025-06-23T16:51:39.361+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 180, "total": 194}
2025-06-23T16:51:39.362+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766351", "processed": 190, "total": 194}
2025-06-23T16:51:39.362+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766351", "successful": 194}
2025-06-23T16:51:39.362+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766351, "count": 194}
2025-06-23T16:51:39.362+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766351}
2025-06-23T16:51:39.362+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766351, "transaction_count": 194}
2025-06-23T16:51:41.056+0700	DEBUG	service/crawler_service.go:497	Batch upsert succeeded	{"component": "crawler-service", "block_number": 22766351, "transaction_count": 194, "duration": "1.694146584s"}
2025-06-23T16:51:41.057+0700	INFO	service/crawler_service.go:430	Transactions saved to database	{"component": "crawler-service", "block_number": 22766351, "count": 194}
2025-06-23T16:51:41.164+0700	INFO	service/crawler_service.go:441	Block processed successfully	{"component": "crawler-service", "block_number": 22766351, "transaction_count": 194}
2025-06-23T16:51:49.524+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:51:49.525+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766352"}
2025-06-23T16:51:49.525+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766352"}
2025-06-23T16:51:49.525+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766352"}
2025-06-23T16:51:49.525+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766352, "block_number": 22766352}
2025-06-23T16:51:49.525+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766352"}
2025-06-23T16:51:50.123+0700	INFO	service/crawler_service.go:412	Block saved to database	{"component": "crawler-service", "block_number": 22766352}
2025-06-23T16:51:50.124+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766352, "tx_hash_count": 277}
2025-06-23T16:51:50.418+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766352", "tx_count": 277}
2025-06-23T16:51:50.419+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 10, "total": 277}
2025-06-23T16:51:50.419+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 20, "total": 277}
2025-06-23T16:51:50.420+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 30, "total": 277}
2025-06-23T16:51:50.420+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 40, "total": 277}
2025-06-23T16:51:50.420+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 50, "total": 277}
2025-06-23T16:51:50.421+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 60, "total": 277}
2025-06-23T16:51:50.421+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 70, "total": 277}
2025-06-23T16:51:50.422+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 80, "total": 277}
2025-06-23T16:51:50.422+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 90, "total": 277}
2025-06-23T16:51:50.422+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 100, "total": 277}
2025-06-23T16:51:50.423+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 110, "total": 277}
2025-06-23T16:51:50.423+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 120, "total": 277}
2025-06-23T16:51:50.424+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 130, "total": 277}
2025-06-23T16:51:50.424+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 140, "total": 277}
2025-06-23T16:51:50.424+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 150, "total": 277}
2025-06-23T16:51:50.425+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 160, "total": 277}
2025-06-23T16:51:50.425+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 170, "total": 277}
2025-06-23T16:51:50.426+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 180, "total": 277}
2025-06-23T16:51:50.426+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 190, "total": 277}
2025-06-23T16:51:50.426+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 200, "total": 277}
2025-06-23T16:51:50.427+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 210, "total": 277}
2025-06-23T16:51:50.427+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 220, "total": 277}
2025-06-23T16:51:50.428+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 230, "total": 277}
2025-06-23T16:51:50.428+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 240, "total": 277}
2025-06-23T16:51:50.428+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 250, "total": 277}
2025-06-23T16:51:50.429+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 260, "total": 277}
2025-06-23T16:51:50.429+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766352", "processed": 270, "total": 277}
2025-06-23T16:51:50.430+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766352", "successful": 277}
2025-06-23T16:51:50.430+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766352, "count": 277}
2025-06-23T16:51:50.430+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766352}
2025-06-23T16:51:50.430+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766352, "transaction_count": 277}
2025-06-23T16:51:52.602+0700	DEBUG	service/crawler_service.go:497	Batch upsert succeeded	{"component": "crawler-service", "block_number": 22766352, "transaction_count": 277, "duration": "2.172143584s"}
2025-06-23T16:51:52.602+0700	INFO	service/crawler_service.go:430	Transactions saved to database	{"component": "crawler-service", "block_number": 22766352, "count": 277}
2025-06-23T16:51:52.697+0700	INFO	service/crawler_service.go:441	Block processed successfully	{"component": "crawler-service", "block_number": 22766352, "transaction_count": 277}
2025-06-23T16:51:56.652+0700	INFO	service/crawler_service.go:757	Health check completed	{"component": "crawler-service", "overall_status": "healthy", "message": "All systems operational", "total_time": "567.823666ms", "consecutive_failures": 0}
2025-06-23T16:51:56.937+0700	DEBUG	blockchain/websocket_scheduler.go:364	Sending WebSocket ping	{"component": "websocket-scheduler"}
2025-06-23T16:51:56.937+0700	DEBUG	blockchain/websocket_scheduler.go:374	WebSocket ping successful	{"component": "websocket-scheduler"}
2025-06-23T16:52:02.135+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:52:02.136+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766353"}
2025-06-23T16:52:02.136+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766353"}
2025-06-23T16:52:02.136+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766353"}
2025-06-23T16:52:02.136+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766353, "block_number": 22766353}
2025-06-23T16:52:02.136+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766353"}
2025-06-23T16:52:02.622+0700	INFO	service/crawler_service.go:412	Block saved to database	{"component": "crawler-service", "block_number": 22766353}
2025-06-23T16:52:02.623+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766353, "tx_hash_count": 160}
2025-06-23T16:52:02.876+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766353", "tx_count": 160}
2025-06-23T16:52:02.876+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 10, "total": 160}
2025-06-23T16:52:02.877+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 20, "total": 160}
2025-06-23T16:52:02.877+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 30, "total": 160}
2025-06-23T16:52:02.877+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 40, "total": 160}
2025-06-23T16:52:02.878+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 50, "total": 160}
2025-06-23T16:52:02.878+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 60, "total": 160}
2025-06-23T16:52:02.879+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 70, "total": 160}
2025-06-23T16:52:02.879+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 80, "total": 160}
2025-06-23T16:52:02.879+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 90, "total": 160}
2025-06-23T16:52:02.880+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 100, "total": 160}
2025-06-23T16:52:02.880+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 110, "total": 160}
2025-06-23T16:52:02.881+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 120, "total": 160}
2025-06-23T16:52:02.881+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 130, "total": 160}
2025-06-23T16:52:02.882+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 140, "total": 160}
2025-06-23T16:52:02.882+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 150, "total": 160}
2025-06-23T16:52:02.882+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766353", "processed": 160, "total": 160}
2025-06-23T16:52:02.882+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766353", "successful": 160}
2025-06-23T16:52:02.882+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766353, "count": 160}
2025-06-23T16:52:02.882+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766353}
2025-06-23T16:52:02.882+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766353, "transaction_count": 160}
2025-06-23T16:52:03.660+0700	DEBUG	service/crawler_service.go:497	Batch upsert succeeded	{"component": "crawler-service", "block_number": 22766353, "transaction_count": 160, "duration": "777.417166ms"}
2025-06-23T16:52:03.660+0700	INFO	service/crawler_service.go:430	Transactions saved to database	{"component": "crawler-service", "block_number": 22766353, "count": 160}
2025-06-23T16:52:03.756+0700	INFO	service/crawler_service.go:441	Block processed successfully	{"component": "crawler-service", "block_number": 22766353, "transaction_count": 160}
2025-06-23T16:52:13.308+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:52:13.309+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766354"}
2025-06-23T16:52:13.309+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766354"}
2025-06-23T16:52:13.309+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766354"}
2025-06-23T16:52:13.309+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766354, "block_number": 22766354}
2025-06-23T16:52:13.309+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766354"}
2025-06-23T16:52:13.912+0700	INFO	service/crawler_service.go:412	Block saved to database	{"component": "crawler-service", "block_number": 22766354}
2025-06-23T16:52:13.913+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766354, "tx_hash_count": 221}
2025-06-23T16:52:14.168+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766354", "tx_count": 221}
2025-06-23T16:52:14.168+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 10, "total": 221}
2025-06-23T16:52:14.168+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 20, "total": 221}
2025-06-23T16:52:14.169+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 30, "total": 221}
2025-06-23T16:52:14.169+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 40, "total": 221}
2025-06-23T16:52:14.170+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 50, "total": 221}
2025-06-23T16:52:14.170+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 60, "total": 221}
2025-06-23T16:52:14.170+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 70, "total": 221}
2025-06-23T16:52:14.171+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 80, "total": 221}
2025-06-23T16:52:14.171+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 90, "total": 221}
2025-06-23T16:52:14.172+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 100, "total": 221}
2025-06-23T16:52:14.172+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 110, "total": 221}
2025-06-23T16:52:14.172+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 120, "total": 221}
2025-06-23T16:52:14.173+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 130, "total": 221}
2025-06-23T16:52:14.173+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 140, "total": 221}
2025-06-23T16:52:14.174+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 150, "total": 221}
2025-06-23T16:52:14.174+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 160, "total": 221}
2025-06-23T16:52:14.174+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 170, "total": 221}
2025-06-23T16:52:14.175+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 180, "total": 221}
2025-06-23T16:52:14.175+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 190, "total": 221}
2025-06-23T16:52:14.176+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 200, "total": 221}
2025-06-23T16:52:14.176+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 210, "total": 221}
2025-06-23T16:52:14.176+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766354", "processed": 220, "total": 221}
2025-06-23T16:52:14.177+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766354", "successful": 221}
2025-06-23T16:52:14.177+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766354, "count": 221}
2025-06-23T16:52:14.177+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766354}
2025-06-23T16:52:14.177+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766354, "transaction_count": 221}
2025-06-23T16:52:15.230+0700	DEBUG	service/crawler_service.go:497	Batch upsert succeeded	{"component": "crawler-service", "block_number": 22766354, "transaction_count": 221, "duration": "1.053033583s"}
2025-06-23T16:52:15.230+0700	INFO	service/crawler_service.go:430	Transactions saved to database	{"component": "crawler-service", "block_number": 22766354, "count": 221}
2025-06-23T16:52:15.333+0700	INFO	service/crawler_service.go:441	Block processed successfully	{"component": "crawler-service", "block_number": 22766354, "transaction_count": 221}
2025-06-23T16:52:26.655+0700	INFO	service/crawler_service.go:757	Health check completed	{"component": "crawler-service", "overall_status": "healthy", "message": "All systems operational", "total_time": "572.739041ms", "consecutive_failures": 0}
2025-06-23T16:52:26.939+0700	DEBUG	blockchain/websocket_scheduler.go:364	Sending WebSocket ping	{"component": "websocket-scheduler"}
2025-06-23T16:52:26.939+0700	DEBUG	blockchain/websocket_scheduler.go:374	WebSocket ping successful	{"component": "websocket-scheduler"}
2025-06-23T16:52:28.357+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:52:28.357+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766355"}
2025-06-23T16:52:28.357+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766355"}
2025-06-23T16:52:28.357+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766355"}
2025-06-23T16:52:28.357+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766355, "block_number": 22766355}
2025-06-23T16:52:28.357+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766355"}
2025-06-23T16:52:28.883+0700	INFO	service/crawler_service.go:412	Block saved to database	{"component": "crawler-service", "block_number": 22766355}
2025-06-23T16:52:28.883+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766355, "tx_hash_count": 151}
2025-06-23T16:52:29.149+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766355", "tx_count": 151}
2025-06-23T16:52:29.150+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766355", "processed": 10, "total": 151}
2025-06-23T16:52:29.151+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766355", "processed": 20, "total": 151}
2025-06-23T16:52:29.152+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766355", "processed": 30, "total": 151}
2025-06-23T16:52:29.152+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766355", "processed": 40, "total": 151}
2025-06-23T16:52:29.153+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766355", "processed": 50, "total": 151}
2025-06-23T16:52:29.153+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766355", "processed": 60, "total": 151}
2025-06-23T16:52:29.153+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766355", "processed": 70, "total": 151}
2025-06-23T16:52:29.154+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766355", "processed": 80, "total": 151}
2025-06-23T16:52:29.154+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766355", "processed": 90, "total": 151}
2025-06-23T16:52:29.155+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766355", "processed": 100, "total": 151}
2025-06-23T16:52:29.155+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766355", "processed": 110, "total": 151}
2025-06-23T16:52:29.155+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766355", "processed": 120, "total": 151}
2025-06-23T16:52:29.156+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766355", "processed": 130, "total": 151}
2025-06-23T16:52:29.156+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766355", "processed": 140, "total": 151}
2025-06-23T16:52:29.157+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766355", "processed": 150, "total": 151}
2025-06-23T16:52:29.157+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766355", "successful": 151}
2025-06-23T16:52:29.157+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766355, "count": 151}
2025-06-23T16:52:29.157+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766355}
2025-06-23T16:52:29.157+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766355, "transaction_count": 151}
2025-06-23T16:52:30.618+0700	DEBUG	service/crawler_service.go:497	Batch upsert succeeded	{"component": "crawler-service", "block_number": 22766355, "transaction_count": 151, "duration": "1.461755417s"}
2025-06-23T16:52:30.618+0700	INFO	service/crawler_service.go:430	Transactions saved to database	{"component": "crawler-service", "block_number": 22766355, "count": 151}
2025-06-23T16:52:30.721+0700	INFO	service/crawler_service.go:441	Block processed successfully	{"component": "crawler-service", "block_number": 22766355, "transaction_count": 151}
2025-06-23T16:52:38.590+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:52:38.591+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766356"}
2025-06-23T16:52:38.591+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766356"}
2025-06-23T16:52:38.591+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766356"}
2025-06-23T16:52:38.591+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766356, "block_number": 22766356}
2025-06-23T16:52:38.591+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766356"}
2025-06-23T16:52:39.172+0700	INFO	service/crawler_service.go:412	Block saved to database	{"component": "crawler-service", "block_number": 22766356}
2025-06-23T16:52:39.172+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766356, "tx_hash_count": 286}
2025-06-23T16:52:39.443+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766356", "tx_count": 286}
2025-06-23T16:52:39.444+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 10, "total": 286}
2025-06-23T16:52:39.444+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 20, "total": 286}
2025-06-23T16:52:39.445+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 30, "total": 286}
2025-06-23T16:52:39.447+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 40, "total": 286}
2025-06-23T16:52:39.447+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 50, "total": 286}
2025-06-23T16:52:39.448+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 60, "total": 286}
2025-06-23T16:52:39.448+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 70, "total": 286}
2025-06-23T16:52:39.448+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 80, "total": 286}
2025-06-23T16:52:39.449+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 90, "total": 286}
2025-06-23T16:52:39.449+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 100, "total": 286}
2025-06-23T16:52:39.450+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 110, "total": 286}
2025-06-23T16:52:39.450+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 120, "total": 286}
2025-06-23T16:52:39.450+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 130, "total": 286}
2025-06-23T16:52:39.451+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 140, "total": 286}
2025-06-23T16:52:39.451+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 150, "total": 286}
2025-06-23T16:52:39.452+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 160, "total": 286}
2025-06-23T16:52:39.452+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 170, "total": 286}
2025-06-23T16:52:39.452+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 180, "total": 286}
2025-06-23T16:52:39.453+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 190, "total": 286}
2025-06-23T16:52:39.453+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 200, "total": 286}
2025-06-23T16:52:39.453+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 210, "total": 286}
2025-06-23T16:52:39.454+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 220, "total": 286}
2025-06-23T16:52:39.454+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 230, "total": 286}
2025-06-23T16:52:39.455+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 240, "total": 286}
2025-06-23T16:52:39.455+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 250, "total": 286}
2025-06-23T16:52:39.455+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 260, "total": 286}
2025-06-23T16:52:39.456+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 270, "total": 286}
2025-06-23T16:52:39.456+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766356", "processed": 280, "total": 286}
2025-06-23T16:52:39.456+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766356", "successful": 286}
2025-06-23T16:52:39.456+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766356, "count": 286}
2025-06-23T16:52:39.456+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766356}
2025-06-23T16:52:39.456+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766356, "transaction_count": 286}
2025-06-23T16:52:41.188+0700	DEBUG	service/crawler_service.go:497	Batch upsert succeeded	{"component": "crawler-service", "block_number": 22766356, "transaction_count": 286, "duration": "1.731397291s"}
2025-06-23T16:52:41.188+0700	INFO	service/crawler_service.go:430	Transactions saved to database	{"component": "crawler-service", "block_number": 22766356, "count": 286}
2025-06-23T16:52:41.288+0700	INFO	service/crawler_service.go:441	Block processed successfully	{"component": "crawler-service", "block_number": 22766356, "transaction_count": 286}
2025-06-23T16:52:49.404+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:52:49.408+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766357"}
2025-06-23T16:52:49.408+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766357"}
2025-06-23T16:52:49.408+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766357"}
2025-06-23T16:52:49.408+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766357, "block_number": 22766357}
2025-06-23T16:52:49.408+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766357"}
2025-06-23T16:52:49.998+0700	INFO	service/crawler_service.go:412	Block saved to database	{"component": "crawler-service", "block_number": 22766357}
2025-06-23T16:52:49.998+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766357, "tx_hash_count": 253}
2025-06-23T16:52:50.294+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766357", "tx_count": 253}
2025-06-23T16:52:50.296+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 10, "total": 253}
2025-06-23T16:52:50.297+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 20, "total": 253}
2025-06-23T16:52:50.298+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 30, "total": 253}
2025-06-23T16:52:50.299+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 40, "total": 253}
2025-06-23T16:52:50.300+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 50, "total": 253}
2025-06-23T16:52:50.302+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 60, "total": 253}
2025-06-23T16:52:50.306+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 70, "total": 253}
2025-06-23T16:52:50.306+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 80, "total": 253}
2025-06-23T16:52:50.307+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 90, "total": 253}
2025-06-23T16:52:50.307+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 100, "total": 253}
2025-06-23T16:52:50.308+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 110, "total": 253}
2025-06-23T16:52:50.308+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 120, "total": 253}
2025-06-23T16:52:50.309+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 130, "total": 253}
2025-06-23T16:52:50.309+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 140, "total": 253}
2025-06-23T16:52:50.310+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 150, "total": 253}
2025-06-23T16:52:50.310+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 160, "total": 253}
2025-06-23T16:52:50.311+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 170, "total": 253}
2025-06-23T16:52:50.311+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 180, "total": 253}
2025-06-23T16:52:50.311+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 190, "total": 253}
2025-06-23T16:52:50.312+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 200, "total": 253}
2025-06-23T16:52:50.312+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 210, "total": 253}
2025-06-23T16:52:50.313+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 220, "total": 253}
2025-06-23T16:52:50.313+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 230, "total": 253}
2025-06-23T16:52:50.313+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 240, "total": 253}
2025-06-23T16:52:50.314+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766357", "processed": 250, "total": 253}
2025-06-23T16:52:50.314+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766357", "successful": 253}
2025-06-23T16:52:50.314+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766357, "count": 253}
2025-06-23T16:52:50.314+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766357}
2025-06-23T16:52:50.314+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766357, "transaction_count": 253}
2025-06-23T16:52:51.197+0700	DEBUG	service/crawler_service.go:497	Batch upsert succeeded	{"component": "crawler-service", "block_number": 22766357, "transaction_count": 253, "duration": "882.640208ms"}
2025-06-23T16:52:51.197+0700	INFO	service/crawler_service.go:430	Transactions saved to database	{"component": "crawler-service", "block_number": 22766357, "count": 253}
2025-06-23T16:52:51.300+0700	INFO	service/crawler_service.go:441	Block processed successfully	{"component": "crawler-service", "block_number": 22766357, "transaction_count": 253}
2025-06-23T16:52:54.331+0700	INFO	blockchain/websocket_scheduler.go:324	Connection monitor context cancelled	{"component": "websocket-scheduler"}
2025-06-23T16:53:02.640+0700	DEBUG	blockchain/websocket_scheduler.go:253	Received WebSocket message	{"component": "websocket-scheduler", "message_type": "eth_subscription"}
2025-06-23T16:53:02.643+0700	INFO	blockchain/websocket_scheduler.go:291	Received new block notification	{"component": "websocket-scheduler", "block_number": "22766358"}
2025-06-23T16:53:02.643+0700	INFO	blockchain/websocket_scheduler.go:209	Message listener context cancelled	{"component": "websocket-scheduler"}
2025-06-23T16:53:02.643+0700	INFO	blockchain/websocket_scheduler.go:198	Message listener stopped	{"component": "websocket-scheduler"}
2025-06-23T16:53:02.643+0700	INFO	service/scheduler_service.go:209	Received new block notification	{"component": "scheduler-service", "block_number": "22766358"}
2025-06-23T16:53:02.643+0700	INFO	service/crawler_service.go:354	Processing specific block from scheduler	{"component": "crawler-service", "block_number": "22766358"}
2025-06-23T16:53:02.643+0700	INFO	service/crawler_service.go:376	Starting to process block	{"component": "crawler-service", "block_number": 22766358, "block_number": 22766358}
2025-06-23T16:53:02.643+0700	DEBUG	blockchain/ethereum_service.go:103	Getting block by number	{"component": "ethereum-service", "block_number": "22766358"}
2025-06-23T16:53:03.137+0700	INFO	service/crawler_service.go:412	Block saved to database	{"component": "crawler-service", "block_number": 22766358}
2025-06-23T16:53:03.137+0700	INFO	service/crawler_service.go:417	Getting transactions for block	{"component": "crawler-service", "block_number": 22766358, "tx_hash_count": 234}
2025-06-23T16:53:03.412+0700	INFO	blockchain/ethereum_service.go:214	Processing transactions in block	{"component": "ethereum-service", "block_number": "22766358", "tx_count": 234}
2025-06-23T16:53:03.413+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 10, "total": 234}
2025-06-23T16:53:03.413+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 20, "total": 234}
2025-06-23T16:53:03.414+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 30, "total": 234}
2025-06-23T16:53:03.414+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 40, "total": 234}
2025-06-23T16:53:03.415+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 50, "total": 234}
2025-06-23T16:53:03.415+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 60, "total": 234}
2025-06-23T16:53:03.416+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 70, "total": 234}
2025-06-23T16:53:03.416+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 80, "total": 234}
2025-06-23T16:53:03.416+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 90, "total": 234}
2025-06-23T16:53:03.417+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 100, "total": 234}
2025-06-23T16:53:03.417+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 110, "total": 234}
2025-06-23T16:53:03.418+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 120, "total": 234}
2025-06-23T16:53:03.418+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 130, "total": 234}
2025-06-23T16:53:03.418+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 140, "total": 234}
2025-06-23T16:53:03.419+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 150, "total": 234}
2025-06-23T16:53:03.419+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 160, "total": 234}
2025-06-23T16:53:03.419+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 170, "total": 234}
2025-06-23T16:53:03.420+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 180, "total": 234}
2025-06-23T16:53:03.420+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 190, "total": 234}
2025-06-23T16:53:03.420+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 200, "total": 234}
2025-06-23T16:53:03.421+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 210, "total": 234}
2025-06-23T16:53:03.421+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 220, "total": 234}
2025-06-23T16:53:03.422+0700	INFO	blockchain/ethereum_service.go:247	Transaction processing progress	{"component": "ethereum-service", "block_number": "22766358", "processed": 230, "total": 234}
2025-06-23T16:53:03.422+0700	INFO	blockchain/ethereum_service.go:254	Completed processing transactions in block	{"component": "ethereum-service", "block_number": "22766358", "successful": 234}
2025-06-23T16:53:03.422+0700	INFO	service/crawler_service.go:423	Retrieved transactions	{"component": "crawler-service", "block_number": 22766358, "count": 234}
2025-06-23T16:53:03.422+0700	DEBUG	service/crawler_service.go:530	Messaging service not connected, skipping transaction publishing	{"component": "crawler-service", "block_number": 22766358}
2025-06-23T16:53:03.422+0700	DEBUG	service/crawler_service.go:462	Attempting batch upsert	{"component": "crawler-service", "block_number": 22766358, "transaction_count": 234}
2025-06-23T16:53:04.219+0700	DEBUG	service/crawler_service.go:497	Batch upsert succeeded	{"component": "crawler-service", "block_number": 22766358, "transaction_count": 234, "duration": "797.559167ms"}
2025-06-23T16:53:04.219+0700	INFO	service/crawler_service.go:430	Transactions saved to database	{"component": "crawler-service", "block_number": 22766358, "count": 234}
2025-06-23T16:53:04.317+0700	INFO	service/crawler_service.go:441	Block processed successfully	{"component": "crawler-service", "block_number": 22766358, "transaction_count": 234}
